=== Suite started at 2016-01-26 18:37:58
=== Starting test, 11 test cases
=cases         11
=user          travis
=host          testing-gce-a86fa482-0e18-4b30-8d8e-7de4dc1e0883
=hosts         testing-gce-a86fa482-0e18-4b30-8d8e-7de4dc1e0883 
=emulator_vsn  6.4
=emulator      beam
=otp_release   17
=started       2016-01-26 18:37:58
=case          oauth_SUITE:init_per_suite
=logfile       oauth_suite.init_per_suite.html
=started       2016-01-26 18:37:58
=ended         2016-01-26 18:37:58
=result        ok
=elapsed       0.005882
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.html
=group_props   [{name,token_login},sequence]
=started       2016-01-26 18:37:58
=ended         2016-01-26 18:37:59
=result        ok
=elapsed       0.520323
=case          oauth_SUITE:request_tokens_test
=logfile       oauth_suite.request_tokens_test.html
=started       2016-01-26 18:37:59
=ended         2016-01-26 18:37:59
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"81e7d9586ec6ec4409bfe43e3992a4cd">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,304}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,157}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      304},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      157},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      151},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 1 of 11 ***
=== 
=case          oauth_SUITE:login_access_token_test
=group_props   [{name,"token_login"}]
=started       2016-01-26 18:37:59
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #2 {oauth_SUITE,login_access_token_test} ***
=== 
=case          oauth_SUITE:login_refresh_token_test
=group_props   [{name,"token_login"}]
=started       2016-01-26 18:37:59
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #3 {oauth_SUITE,login_refresh_token_test} ***
=== 
=case          oauth_SUITE:login_with_other_users_token
=group_props   [{name,"token_login"}]
=started       2016-01-26 18:37:59
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #4 {oauth_SUITE,login_with_other_users_token} ***
=== 
=case          oauth_SUITE:login_with_malformed_token
=group_props   [{name,"token_login"}]
=started       2016-01-26 18:37:59
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #5 {oauth_SUITE,login_with_malformed_token} ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.html
=group_props   [{name,token_login},sequence]
=started       2016-01-26 18:37:59
=ended         2016-01-26 18:38:00
=result        ok
=elapsed       0.923371
=group_time    1.049s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.833480.741.html
=group_props   [{name,token_revocation},sequence]
=started       2016-01-26 18:38:00
=ended         2016-01-26 18:38:01
=result        ok
=elapsed       0.510343
=case          oauth_SUITE:login_with_revoked_token_test
=logfile       oauth_suite.login_with_revoked_token_test.html
=started       2016-01-26 18:38:01
=ended         2016-01-26 18:38:01
=result        failed: {badarg,
                           [{erlang,setelement,[5,{error,{error,undef}},0],[]},
                            {oauth_SUITE,'-record_set/2-fun-0-',2,
                                [{file,"oauth_SUITE.erl"},{line,351}]},
                            {lists,foldl,3,[{file,"lists.erl"},{line,1261}]},
                            {oauth_SUITE,get_revoked_token,2,
                                [{file,"oauth_SUITE.erl"},{line,136}]},
                            {oauth_SUITE,login_with_revoked_token_test,1,
                                [{file,"oauth_SUITE.erl"},{line,121}]},
                            {test_server,ts_tc,3,
                                [{file,"test_server.erl"},{line,1429}]},
                            {test_server,run_test_case_eval1,6,
                                [{file,"test_server.erl"},{line,1026}]},
                            {test_server,run_test_case_eval,9,
                                [{file,"test_server.erl"},{line,968}]}]}, [{erlang,
                                                                            setelement},
                                                                           {oauth_SUITE,
                                                                            '-record_set/2-fun-0-',
                                                                            351},
                                                                           {lists,
                                                                            foldl,
                                                                            1261},
                                                                           {oauth_SUITE,
                                                                            get_revoked_token,
                                                                            136},
                                                                           {oauth_SUITE,
                                                                            login_with_revoked_token_test,
                                                                            121},
                                                                           {test_server,
                                                                            ts_tc,
                                                                            1429},
                                                                           {test_server,
                                                                            run_test_case_eval1,
                                                                            1026},
                                                                           {test_server,
                                                                            run_test_case_eval,
                                                                            968}]
=== *** FAILED test case 6 of 11 ***
=== 
=case          oauth_SUITE:token_revocation_test
=group_props   [{name,"token_revocation"}]
=started       2016-01-26 18:38:01
=result        auto_skipped: {failed,{oauth_SUITE,login_with_revoked_token_test}}
=== *** Skipping test case #7 {oauth_SUITE,token_revocation_test} ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.833481.321.html
=group_props   [{name,token_revocation},sequence]
=started       2016-01-26 18:38:01
=ended         2016-01-26 18:38:02
=result        ok
=elapsed       0.928096
=group_time    0.580s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.833482.274.html
=group_props   [{name,provision_token}]
=started       2016-01-26 18:38:02
=ended         2016-01-26 18:38:02
=result        ok
=elapsed       0.519516
=case          oauth_SUITE:provision_token_login
=logfile       oauth_suite.provision_token_login.html
=started       2016-01-26 18:38:02
=ended         2016-01-26 18:38:02
=result        failed: {{badmatch,
                         {badrpc,
                          {'EXIT',
                           {{badmatch,[]},
                            [{mod_auth_token,get_key_for_user,2,
                              [{file,"src/mod_auth_token.erl"},{line,375}]},
                             {mod_auth_token,user_hmac_opts,2,
                              [{file,"src/mod_auth_token.erl"},{line,135}]},
                             {mod_auth_token,token_with_mac,1,
                              [{file,"src/mod_auth_token.erl"},{line,129}]},
                             {rpc,'-handle_call_call/6-fun-0-',5,
                              [{file,"rpc.erl"},{line,205}]}]}}}},
                        [{oauth_SUITE,make_provision_token,3,
                          [{file,"oauth_SUITE.erl"},{line,418}]},
                         {oauth_SUITE,provision_token_login,1,
                          [{file,"oauth_SUITE.erl"},{line,291}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      make_provision_token,
                                                                      418},
                                                                     {oauth_SUITE,
                                                                      provision_token_login,
                                                                      291},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 8 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.833482.848.html
=group_props   [{name,provision_token}]
=started       2016-01-26 18:38:02
=ended         2016-01-26 18:38:03
=result        ok
=elapsed       0.92755
=group_time    0.574s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.833483.801.html
=group_props   [{name,commands}]
=started       2016-01-26 18:38:03
=ended         2016-01-26 18:38:04
=result        ok
=elapsed       0.515978
=case          oauth_SUITE:revoke_token_cmd_when_no_token
=logfile       oauth_suite.revoke_token_cmd_when_no_token.html
=started       2016-01-26 18:38:04
=ended         2016-01-26 18:38:04
=result        failed: {{badmatch,"Error: command \"revoke_token\" not known.\n"},
                        [{oauth_SUITE,revoke_token_cmd_when_no_token,1,
                                      [{file,"oauth_SUITE.erl"},{line,263}]},
                         {test_server,ts_tc,3,
                                      [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                                      [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                                      [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                                  revoke_token_cmd_when_no_token,
                                                                                  263},
                                                                                 {test_server,
                                                                                  ts_tc,
                                                                                  1429},
                                                                                 {test_server,
                                                                                  run_test_case_eval1,
                                                                                  1026},
                                                                                 {test_server,
                                                                                  run_test_case_eval,
                                                                                  968}]
=== *** FAILED test case 9 of 11 ***
=case          oauth_SUITE:revoke_token_cmd
=logfile       oauth_suite.revoke_token_cmd.html
=started       2016-01-26 18:38:04
=ended         2016-01-26 18:38:04
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"617d850efebc70c50216ab4d9d0dafef">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,304}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,157}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {oauth_SUITE,revoke_token_cmd,1,
                          [{file,"oauth_SUITE.erl"},{line,267}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      304},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      157},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      151},
                                                                     {oauth_SUITE,
                                                                      revoke_token_cmd,
                                                                      267},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 10 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.833485.6.html
=group_props   [{name,commands}]
=started       2016-01-26 18:38:05
=ended         2016-01-26 18:38:05
=result        ok
=elapsed       0.928584
=group_time    1.205s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.833485.961.html
=group_props   [{name,cleanup}]
=started       2016-01-26 18:38:05
=ended         2016-01-26 18:38:06
=result        ok
=elapsed       0.516158
=case          oauth_SUITE:token_removed_on_user_removal
=logfile       oauth_suite.token_removed_on_user_removal.html
=started       2016-01-26 18:38:06
=ended         2016-01-26 18:38:06
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"2cef923cfef5ead8bab0d73f995f037f">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,304}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,157}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {oauth_SUITE,token_removed_on_user_removal,1,
                          [{file,"oauth_SUITE.erl"},{line,275}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      304},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      157},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      151},
                                                                     {oauth_SUITE,
                                                                      token_removed_on_user_removal,
                                                                      275},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 11 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.833486.996.html
=group_props   [{name,cleanup}]
=started       2016-01-26 18:38:06
=ended         2016-01-26 18:38:07
=result        ok
=elapsed       0.462769
=group_time    1.035s
=case          oauth_SUITE:end_per_suite
=logfile       oauth_suite.end_per_suite.html
=started       2016-01-26 18:38:07
=ended         2016-01-26 18:38:07
=result        ok
=elapsed       0.038547
=group_time    8.814s
=== TEST COMPLETE, 0 ok, 6 failed, 5 skipped of 11 test cases

=finished      2016-01-26 18:38:07
=failed        6
=successful    0
=user_skipped  0
=auto_skipped  5
