=== Suite started at 2016-01-25 20:37:27
=== Starting test, 11 test cases
=cases         11
=user          travis
=host          testing-gce-de643d04-f343-4319-93d1-947994042071
=hosts         testing-gce-de643d04-f343-4319-93d1-947994042071 
=emulator_vsn  6.4
=emulator      beam
=otp_release   17
=started       2016-01-25 20:37:27
=case          oauth_SUITE:init_per_suite
=logfile       oauth_suite.init_per_suite.html
=started       2016-01-25 20:37:27
=ended         2016-01-25 20:37:27
=result        ok
=elapsed       0.004302
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.html
=group_props   [{name,token_login},sequence]
=started       2016-01-25 20:37:27
=ended         2016-01-25 20:37:28
=result        ok
=elapsed       0.517093
=case          oauth_SUITE:request_tokens_test
=logfile       oauth_suite.request_tokens_test.html
=started       2016-01-25 20:37:28
=ended         2016-01-25 20:37:28
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"301a25e2e2ddb9d1b2cc4c56528dfa08">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,298}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,145}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      298},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      151},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      145},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 1 of 11 ***
=== 
=case          oauth_SUITE:login_access_token_test
=group_props   [{name,"token_login"}]
=started       2016-01-25 20:37:28
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #2 {oauth_SUITE,login_access_token_test} ***
=== 
=case          oauth_SUITE:login_refresh_token_test
=group_props   [{name,"token_login"}]
=started       2016-01-25 20:37:28
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #3 {oauth_SUITE,login_refresh_token_test} ***
=== 
=case          oauth_SUITE:login_with_other_users_token
=group_props   [{name,"token_login"}]
=started       2016-01-25 20:37:28
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #4 {oauth_SUITE,login_with_other_users_token} ***
=== 
=case          oauth_SUITE:login_with_malformed_token
=group_props   [{name,"token_login"}]
=started       2016-01-25 20:37:28
=result        auto_skipped: {failed,{oauth_SUITE,request_tokens_test}}
=== *** Skipping test case #5 {oauth_SUITE,login_with_malformed_token} ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.html
=group_props   [{name,token_login},sequence]
=started       2016-01-25 20:37:28
=ended         2016-01-25 20:37:29
=result        ok
=elapsed       0.922734
=group_time    1.040s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.754249.816.html
=group_props   [{name,token_revocation},sequence]
=started       2016-01-25 20:37:29
=ended         2016-01-25 20:37:30
=result        ok
=elapsed       0.50661
=case          oauth_SUITE:login_with_revoked_token_test
=logfile       oauth_suite.login_with_revoked_token_test.html
=started       2016-01-25 20:37:30
=ended         2016-01-25 20:37:30
=result        failed: {badarg,
                           [{erlang,setelement,[5,{error,{error,undef}},0],[]},
                            {oauth_SUITE,'-record_set/2-fun-0-',2,
                                [{file,"oauth_SUITE.erl"},{line,345}]},
                            {lists,foldl,3,[{file,"lists.erl"},{line,1261}]},
                            {oauth_SUITE,get_revoked_token,2,
                                [{file,"oauth_SUITE.erl"},{line,130}]},
                            {oauth_SUITE,login_with_revoked_token_test,1,
                                [{file,"oauth_SUITE.erl"},{line,115}]},
                            {test_server,ts_tc,3,
                                [{file,"test_server.erl"},{line,1429}]},
                            {test_server,run_test_case_eval1,6,
                                [{file,"test_server.erl"},{line,1026}]},
                            {test_server,run_test_case_eval,9,
                                [{file,"test_server.erl"},{line,968}]}]}, [{erlang,
                                                                            setelement},
                                                                           {oauth_SUITE,
                                                                            '-record_set/2-fun-0-',
                                                                            345},
                                                                           {lists,
                                                                            foldl,
                                                                            1261},
                                                                           {oauth_SUITE,
                                                                            get_revoked_token,
                                                                            130},
                                                                           {oauth_SUITE,
                                                                            login_with_revoked_token_test,
                                                                            115},
                                                                           {test_server,
                                                                            ts_tc,
                                                                            1429},
                                                                           {test_server,
                                                                            run_test_case_eval1,
                                                                            1026},
                                                                           {test_server,
                                                                            run_test_case_eval,
                                                                            968}]
=== *** FAILED test case 6 of 11 ***
=== 
=case          oauth_SUITE:token_revocation_test
=group_props   [{name,"token_revocation"}]
=started       2016-01-25 20:37:30
=result        auto_skipped: {failed,{oauth_SUITE,login_with_revoked_token_test}}
=== *** Skipping test case #7 {oauth_SUITE,token_revocation_test} ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.754250.385.html
=group_props   [{name,token_revocation},sequence]
=started       2016-01-25 20:37:30
=ended         2016-01-25 20:37:31
=result        ok
=elapsed       0.928912
=group_time    0.569s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.754251.339.html
=group_props   [{name,provision_token}]
=started       2016-01-25 20:37:31
=ended         2016-01-25 20:37:31
=result        ok
=elapsed       0.5099
=case          oauth_SUITE:provision_token_login
=logfile       oauth_suite.provision_token_login.html
=started       2016-01-25 20:37:31
=ended         2016-01-25 20:37:31
=result        failed: {{badmatch,
                         {badrpc,
                          {'EXIT',
                           {{badmatch,[]},
                            [{mod_auth_token,get_key_for_user,2,
                              [{file,"src/mod_auth_token.erl"},{line,375}]},
                             {mod_auth_token,user_hmac_opts,2,
                              [{file,"src/mod_auth_token.erl"},{line,135}]},
                             {mod_auth_token,token_with_mac,1,
                              [{file,"src/mod_auth_token.erl"},{line,129}]},
                             {rpc,'-handle_call_call/6-fun-0-',5,
                              [{file,"rpc.erl"},{line,205}]}]}}}},
                        [{oauth_SUITE,make_provision_token,3,
                          [{file,"oauth_SUITE.erl"},{line,412}]},
                         {oauth_SUITE,provision_token_login,1,
                          [{file,"oauth_SUITE.erl"},{line,285}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      make_provision_token,
                                                                      412},
                                                                     {oauth_SUITE,
                                                                      provision_token_login,
                                                                      285},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 8 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.754251.911.html
=group_props   [{name,provision_token}]
=started       2016-01-25 20:37:31
=ended         2016-01-25 20:37:32
=result        ok
=elapsed       0.923894
=group_time    0.572s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.754252.860.html
=group_props   [{name,commands}]
=started       2016-01-25 20:37:32
=ended         2016-01-25 20:37:33
=result        ok
=elapsed       0.51138
=case          oauth_SUITE:revoke_token_cmd_when_no_token
=logfile       oauth_suite.revoke_token_cmd_when_no_token.html
=started       2016-01-25 20:37:33
=ended         2016-01-25 20:37:33
=result        failed: {{badmatch,"Error: command \"revoke_token\" not known.\n"},
                        [{oauth_SUITE,revoke_token_cmd_when_no_token,1,
                                      [{file,"oauth_SUITE.erl"},{line,257}]},
                         {test_server,ts_tc,3,
                                      [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                                      [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                                      [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                                  revoke_token_cmd_when_no_token,
                                                                                  257},
                                                                                 {test_server,
                                                                                  ts_tc,
                                                                                  1429},
                                                                                 {test_server,
                                                                                  run_test_case_eval1,
                                                                                  1026},
                                                                                 {test_server,
                                                                                  run_test_case_eval,
                                                                                  968}]
=== *** FAILED test case 9 of 11 ***
=case          oauth_SUITE:revoke_token_cmd
=logfile       oauth_suite.revoke_token_cmd.html
=started       2016-01-25 20:37:33
=ended         2016-01-25 20:37:34
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"452102a822840cbfb576159a1c76be52">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,298}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,145}]},
                         {oauth_SUITE,revoke_token_cmd,1,
                          [{file,"oauth_SUITE.erl"},{line,261}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      298},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      151},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      145},
                                                                     {oauth_SUITE,
                                                                      revoke_token_cmd,
                                                                      261},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 10 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.754254.59.html
=group_props   [{name,commands}]
=started       2016-01-25 20:37:34
=ended         2016-01-25 20:37:35
=result        ok
=elapsed       0.924799
=group_time    1.199s
=case          oauth_SUITE:init_per_group
=logfile       oauth_suite.init_per_group.754255.12.html
=group_props   [{name,cleanup}]
=started       2016-01-25 20:37:35
=ended         2016-01-25 20:37:35
=result        ok
=elapsed       0.510372
=case          oauth_SUITE:token_removed_on_user_removal
=logfile       oauth_suite.token_removed_on_user_removal.html
=started       2016-01-25 20:37:35
=ended         2016-01-25 20:37:36
=result        failed: {function_clause,
                        [{oauth_SUITE,extract_tokens,
                          [{xmlel,<<"iq">>,
                            [{<<"from">>,<<"bOb@localhost">>},
                             {<<"to">>,<<"bOb@localhost/res1">>},
                             {<<"type">>,<<"error">>},
                             {<<"xml:lang">>,<<"en">>},
                             {<<"id">>,
                              <<"2aae480e9b120878af4a5b99010f47b0">>}],
                            [{xmlel,<<"query">>,
                              [{<<"xmlns">>,
                                <<"erlang-solutions.com:xmpp:token-auth:0">>}],
                              []},
                             {xmlel,<<"error">>,
                              [{<<"code">>,<<"503">>},
                               {<<"type">>,<<"cancel">>}],
                              [{xmlel,<<"service-unavailable">>,
                                [{<<"xmlns">>,
                                  <<"urn:ietf:params:xml:ns:xmpp-stanzas">>}],
                                []}]}]}],
                          [{file,"oauth_SUITE.erl"},{line,298}]},
                         {oauth_SUITE,
                          '-request_tokens_once_logged_in_impl/2-fun-0-',3,
                          [{file,"oauth_SUITE.erl"},{line,151}]},
                         {escalus_story,story,3,
                          [{file,"src/escalus_story.erl"},{line,40}]},
                         {oauth_SUITE,request_tokens_once_logged_in_impl,2,
                          [{file,"oauth_SUITE.erl"},{line,145}]},
                         {oauth_SUITE,token_removed_on_user_removal,1,
                          [{file,"oauth_SUITE.erl"},{line,269}]},
                         {test_server,ts_tc,3,
                          [{file,"test_server.erl"},{line,1429}]},
                         {test_server,run_test_case_eval1,6,
                          [{file,"test_server.erl"},{line,1026}]},
                         {test_server,run_test_case_eval,9,
                          [{file,"test_server.erl"},{line,968}]}]}, [{oauth_SUITE,
                                                                      extract_tokens,
                                                                      298},
                                                                     {oauth_SUITE,
                                                                      '-request_tokens_once_logged_in_impl/2-fun-0-',
                                                                      151},
                                                                     {escalus_story,
                                                                      story,
                                                                      40},
                                                                     {oauth_SUITE,
                                                                      request_tokens_once_logged_in_impl,
                                                                      145},
                                                                     {oauth_SUITE,
                                                                      token_removed_on_user_removal,
                                                                      269},
                                                                     {test_server,
                                                                      ts_tc,
                                                                      1429},
                                                                     {test_server,
                                                                      run_test_case_eval1,
                                                                      1026},
                                                                     {test_server,
                                                                      run_test_case_eval,
                                                                      968}]
=== *** FAILED test case 11 of 11 ***
=case          oauth_SUITE:end_per_group
=logfile       oauth_suite.end_per_group.754256.45.html
=group_props   [{name,cleanup}]
=started       2016-01-25 20:37:36
=ended         2016-01-25 20:37:36
=result        ok
=elapsed       0.464724
=group_time    1.033s
=case          oauth_SUITE:end_per_suite
=logfile       oauth_suite.end_per_suite.html
=started       2016-01-25 20:37:36
=ended         2016-01-25 20:37:36
=result        ok
=elapsed       0.033677
=group_time    8.784s
=== TEST COMPLETE, 0 ok, 6 failed, 5 skipped of 11 test cases

=finished      2016-01-25 20:37:36
=failed        6
=successful    0
=user_skipped  0
=auto_skipped  5
