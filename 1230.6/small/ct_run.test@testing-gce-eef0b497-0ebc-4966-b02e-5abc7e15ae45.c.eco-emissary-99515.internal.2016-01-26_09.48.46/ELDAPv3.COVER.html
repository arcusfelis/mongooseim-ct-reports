<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>/home/travis/build/esl/MongooseIM/apps/ejabberd/logs/ct_run.test@testing-gce-eef0b497-0ebc-4966-b02e-5abc7e15ae45.c.eco-emissary-99515.internal.2016-01-26_09.48.46/ELDAPv3.COVER.html</title>
</head><body style='background-color: white; color: black'>
<pre>
File generated from /home/travis/build/esl/MongooseIM/apps/ejabberd/ebin/../src/ELDAPv3.erl by COVER 2016-01-26 at 09:50:02

****************************************************************************

        |  %% Generated by the Erlang ASN.1 BER_V2-compiler version, utilizing bit-syntax:3.0.4
        |  %% Purpose: encoder and decoder to the types in mod ELDAPv3
        |  
        |  -module('ELDAPv3').
        |  -compile(nowarn_unused_vars).
        |  -include("ELDAPv3.hrl").
        |  -asn1_info([{vsn,'3.0.4'},
        |              {module,'ELDAPv3'},
        |              {options,[{i,"src"},{outdir,"src"},noobj,{i,"."},{i,"asn1"}]}]).
        |  
        |  -export([encoding_rule/0,bit_string_format/0,
        |           legacy_erlang_types/0]).
        |  -export(['dialyzer-suppressions'/1]).
        |  -export([
        |  'enc_LDAPMessage'/2,
        |  'enc_MessageID'/2,
        |  'enc_LDAPString'/2,
        |  'enc_LDAPOID'/2,
        |  'enc_LDAPDN'/2,
        |  'enc_RelativeLDAPDN'/2,
        |  'enc_AttributeType'/2,
        |  'enc_AttributeDescription'/2,
        |  'enc_AttributeDescriptionList'/2,
        |  'enc_AttributeValue'/2,
        |  'enc_AttributeValueAssertion'/2,
        |  'enc_AssertionValue'/2,
        |  'enc_Attribute'/2,
        |  'enc_MatchingRuleId'/2,
        |  'enc_LDAPResult'/2,
        |  'enc_Referral'/2,
        |  'enc_LDAPURL'/2,
        |  'enc_Controls'/2,
        |  'enc_Control'/2,
        |  'enc_BindRequest'/2,
        |  'enc_AuthenticationChoice'/2,
        |  'enc_SaslCredentials'/2,
        |  'enc_BindResponse'/2,
        |  'enc_UnbindRequest'/2,
        |  'enc_SearchRequest'/2,
        |  'enc_Filter'/2,
        |  'enc_SubstringFilter'/2,
        |  'enc_MatchingRuleAssertion'/2,
        |  'enc_SearchResultEntry'/2,
        |  'enc_PartialAttributeList'/2,
        |  'enc_SearchResultReference'/2,
        |  'enc_SearchResultDone'/2,
        |  'enc_ModifyRequest'/2,
        |  'enc_AttributeTypeAndValues'/2,
        |  'enc_ModifyResponse'/2,
        |  'enc_AddRequest'/2,
        |  'enc_AttributeList'/2,
        |  'enc_AddResponse'/2,
        |  'enc_DelRequest'/2,
        |  'enc_DelResponse'/2,
        |  'enc_ModifyDNRequest'/2,
        |  'enc_ModifyDNResponse'/2,
        |  'enc_CompareRequest'/2,
        |  'enc_CompareResponse'/2,
        |  'enc_AbandonRequest'/2,
        |  'enc_ExtendedRequest'/2,
        |  'enc_ExtendedResponse'/2,
        |  'enc_PasswdModifyRequestValue'/2,
        |  'enc_PasswdModifyResponseValue'/2
        |  ]).
        |  
        |  -export([
        |  'dec_LDAPMessage'/2,
        |  'dec_MessageID'/2,
        |  'dec_LDAPString'/2,
        |  'dec_LDAPOID'/2,
        |  'dec_LDAPDN'/2,
        |  'dec_RelativeLDAPDN'/2,
        |  'dec_AttributeType'/2,
        |  'dec_AttributeDescription'/2,
        |  'dec_AttributeDescriptionList'/2,
        |  'dec_AttributeValue'/2,
        |  'dec_AttributeValueAssertion'/2,
        |  'dec_AssertionValue'/2,
        |  'dec_Attribute'/2,
        |  'dec_MatchingRuleId'/2,
        |  'dec_LDAPResult'/2,
        |  'dec_Referral'/2,
        |  'dec_LDAPURL'/2,
        |  'dec_Controls'/2,
        |  'dec_Control'/2,
        |  'dec_BindRequest'/2,
        |  'dec_AuthenticationChoice'/2,
        |  'dec_SaslCredentials'/2,
        |  'dec_BindResponse'/2,
        |  'dec_UnbindRequest'/2,
        |  'dec_SearchRequest'/2,
        |  'dec_Filter'/2,
        |  'dec_SubstringFilter'/2,
        |  'dec_MatchingRuleAssertion'/2,
        |  'dec_SearchResultEntry'/2,
        |  'dec_PartialAttributeList'/2,
        |  'dec_SearchResultReference'/2,
        |  'dec_SearchResultDone'/2,
        |  'dec_ModifyRequest'/2,
        |  'dec_AttributeTypeAndValues'/2,
        |  'dec_ModifyResponse'/2,
        |  'dec_AddRequest'/2,
        |  'dec_AttributeList'/2,
        |  'dec_AddResponse'/2,
        |  'dec_DelRequest'/2,
        |  'dec_DelResponse'/2,
        |  'dec_ModifyDNRequest'/2,
        |  'dec_ModifyDNResponse'/2,
        |  'dec_CompareRequest'/2,
        |  'dec_CompareResponse'/2,
        |  'dec_AbandonRequest'/2,
        |  'dec_ExtendedRequest'/2,
        |  'dec_ExtendedResponse'/2,
        |  'dec_PasswdModifyRequestValue'/2,
        |  'dec_PasswdModifyResponseValue'/2
        |  ]).
        |  
        |  -export([
        |  'maxInt'/0,
        |  'passwdModifyOID'/0
        |  ]).
        |  
        |  -export([info/0]).
        |  
        |  
        |  -export([encode/2,decode/2]).
        |  
<font color=red>     0..|  encoding_rule() -&gt; ber.</font>
        |  
<font color=red>     0..|  bit_string_format() -&gt; bitstring.</font>
        |  
<font color=red>     0..|  legacy_erlang_types() -&gt; false.</font>
        |  
        |  encode(Type, Data) -&gt;
<font color=red>     0..|  try iolist_to_binary(element(1, encode_disp(Type, Data))) of</font>
        |    Bytes -&gt;
<font color=red>     0..|      {ok,Bytes}</font>
        |    catch
        |      Class:Exception when Class =:= error; Class =:= exit -&gt;
<font color=red>     0..|        case Exception of</font>
        |          {error,Reason}=Error -&gt;
<font color=red>     0..|            Error;</font>
        |          Reason -&gt;
<font color=red>     0..|           {error,{asn1,Reason}}</font>
        |        end
        |  end.
        |  
        |  decode(Type,Data) -&gt;
<font color=red>     0..|  try decode_disp(Type, element(1, ber_decode_nif(Data))) of</font>
        |    Result -&gt;
<font color=red>     0..|      {ok,Result}</font>
        |    catch
        |      Class:Exception when Class =:= error; Class =:= exit -&gt;
<font color=red>     0..|        case Exception of</font>
        |          {error,Reason}=Error -&gt;
<font color=red>     0..|            Error;</font>
        |          Reason -&gt;
<font color=red>     0..|           {error,{asn1,Reason}}</font>
        |        end
        |  end.
        |  
<font color=red>     0..|  encode_disp('LDAPMessage',Data) -&gt; 'enc_LDAPMessage'(Data);</font>
<font color=red>     0..|  encode_disp('MessageID',Data) -&gt; 'enc_MessageID'(Data);</font>
<font color=red>     0..|  encode_disp('LDAPString',Data) -&gt; 'enc_LDAPString'(Data);</font>
<font color=red>     0..|  encode_disp('LDAPOID',Data) -&gt; 'enc_LDAPOID'(Data);</font>
<font color=red>     0..|  encode_disp('LDAPDN',Data) -&gt; 'enc_LDAPDN'(Data);</font>
<font color=red>     0..|  encode_disp('RelativeLDAPDN',Data) -&gt; 'enc_RelativeLDAPDN'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeType',Data) -&gt; 'enc_AttributeType'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeDescription',Data) -&gt; 'enc_AttributeDescription'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeDescriptionList',Data) -&gt; 'enc_AttributeDescriptionList'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeValue',Data) -&gt; 'enc_AttributeValue'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeValueAssertion',Data) -&gt; 'enc_AttributeValueAssertion'(Data);</font>
<font color=red>     0..|  encode_disp('AssertionValue',Data) -&gt; 'enc_AssertionValue'(Data);</font>
<font color=red>     0..|  encode_disp('Attribute',Data) -&gt; 'enc_Attribute'(Data);</font>
<font color=red>     0..|  encode_disp('MatchingRuleId',Data) -&gt; 'enc_MatchingRuleId'(Data);</font>
<font color=red>     0..|  encode_disp('LDAPResult',Data) -&gt; 'enc_LDAPResult'(Data);</font>
<font color=red>     0..|  encode_disp('Referral',Data) -&gt; 'enc_Referral'(Data);</font>
<font color=red>     0..|  encode_disp('LDAPURL',Data) -&gt; 'enc_LDAPURL'(Data);</font>
<font color=red>     0..|  encode_disp('Controls',Data) -&gt; 'enc_Controls'(Data);</font>
<font color=red>     0..|  encode_disp('Control',Data) -&gt; 'enc_Control'(Data);</font>
<font color=red>     0..|  encode_disp('BindRequest',Data) -&gt; 'enc_BindRequest'(Data);</font>
<font color=red>     0..|  encode_disp('AuthenticationChoice',Data) -&gt; 'enc_AuthenticationChoice'(Data);</font>
<font color=red>     0..|  encode_disp('SaslCredentials',Data) -&gt; 'enc_SaslCredentials'(Data);</font>
<font color=red>     0..|  encode_disp('BindResponse',Data) -&gt; 'enc_BindResponse'(Data);</font>
<font color=red>     0..|  encode_disp('UnbindRequest',Data) -&gt; 'enc_UnbindRequest'(Data);</font>
<font color=red>     0..|  encode_disp('SearchRequest',Data) -&gt; 'enc_SearchRequest'(Data);</font>
<font color=red>     0..|  encode_disp('Filter',Data) -&gt; 'enc_Filter'(Data);</font>
<font color=red>     0..|  encode_disp('SubstringFilter',Data) -&gt; 'enc_SubstringFilter'(Data);</font>
<font color=red>     0..|  encode_disp('MatchingRuleAssertion',Data) -&gt; 'enc_MatchingRuleAssertion'(Data);</font>
<font color=red>     0..|  encode_disp('SearchResultEntry',Data) -&gt; 'enc_SearchResultEntry'(Data);</font>
<font color=red>     0..|  encode_disp('PartialAttributeList',Data) -&gt; 'enc_PartialAttributeList'(Data);</font>
<font color=red>     0..|  encode_disp('SearchResultReference',Data) -&gt; 'enc_SearchResultReference'(Data);</font>
<font color=red>     0..|  encode_disp('SearchResultDone',Data) -&gt; 'enc_SearchResultDone'(Data);</font>
<font color=red>     0..|  encode_disp('ModifyRequest',Data) -&gt; 'enc_ModifyRequest'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeTypeAndValues',Data) -&gt; 'enc_AttributeTypeAndValues'(Data);</font>
<font color=red>     0..|  encode_disp('ModifyResponse',Data) -&gt; 'enc_ModifyResponse'(Data);</font>
<font color=red>     0..|  encode_disp('AddRequest',Data) -&gt; 'enc_AddRequest'(Data);</font>
<font color=red>     0..|  encode_disp('AttributeList',Data) -&gt; 'enc_AttributeList'(Data);</font>
<font color=red>     0..|  encode_disp('AddResponse',Data) -&gt; 'enc_AddResponse'(Data);</font>
<font color=red>     0..|  encode_disp('DelRequest',Data) -&gt; 'enc_DelRequest'(Data);</font>
<font color=red>     0..|  encode_disp('DelResponse',Data) -&gt; 'enc_DelResponse'(Data);</font>
<font color=red>     0..|  encode_disp('ModifyDNRequest',Data) -&gt; 'enc_ModifyDNRequest'(Data);</font>
<font color=red>     0..|  encode_disp('ModifyDNResponse',Data) -&gt; 'enc_ModifyDNResponse'(Data);</font>
<font color=red>     0..|  encode_disp('CompareRequest',Data) -&gt; 'enc_CompareRequest'(Data);</font>
<font color=red>     0..|  encode_disp('CompareResponse',Data) -&gt; 'enc_CompareResponse'(Data);</font>
<font color=red>     0..|  encode_disp('AbandonRequest',Data) -&gt; 'enc_AbandonRequest'(Data);</font>
<font color=red>     0..|  encode_disp('ExtendedRequest',Data) -&gt; 'enc_ExtendedRequest'(Data);</font>
<font color=red>     0..|  encode_disp('ExtendedResponse',Data) -&gt; 'enc_ExtendedResponse'(Data);</font>
<font color=red>     0..|  encode_disp('PasswdModifyRequestValue',Data) -&gt; 'enc_PasswdModifyRequestValue'(Data);</font>
<font color=red>     0..|  encode_disp('PasswdModifyResponseValue',Data) -&gt; 'enc_PasswdModifyResponseValue'(Data);</font>
<font color=red>     0..|  encode_disp(Type,_Data) -&gt; exit({error,{asn1,{undefined_type,Type}}}).</font>
        |  
        |  
<font color=red>     0..|  decode_disp('LDAPMessage',Data) -&gt; 'dec_LDAPMessage'(Data);</font>
<font color=red>     0..|  decode_disp('MessageID',Data) -&gt; 'dec_MessageID'(Data);</font>
<font color=red>     0..|  decode_disp('LDAPString',Data) -&gt; 'dec_LDAPString'(Data);</font>
<font color=red>     0..|  decode_disp('LDAPOID',Data) -&gt; 'dec_LDAPOID'(Data);</font>
<font color=red>     0..|  decode_disp('LDAPDN',Data) -&gt; 'dec_LDAPDN'(Data);</font>
<font color=red>     0..|  decode_disp('RelativeLDAPDN',Data) -&gt; 'dec_RelativeLDAPDN'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeType',Data) -&gt; 'dec_AttributeType'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeDescription',Data) -&gt; 'dec_AttributeDescription'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeDescriptionList',Data) -&gt; 'dec_AttributeDescriptionList'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeValue',Data) -&gt; 'dec_AttributeValue'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeValueAssertion',Data) -&gt; 'dec_AttributeValueAssertion'(Data);</font>
<font color=red>     0..|  decode_disp('AssertionValue',Data) -&gt; 'dec_AssertionValue'(Data);</font>
<font color=red>     0..|  decode_disp('Attribute',Data) -&gt; 'dec_Attribute'(Data);</font>
<font color=red>     0..|  decode_disp('MatchingRuleId',Data) -&gt; 'dec_MatchingRuleId'(Data);</font>
<font color=red>     0..|  decode_disp('LDAPResult',Data) -&gt; 'dec_LDAPResult'(Data);</font>
<font color=red>     0..|  decode_disp('Referral',Data) -&gt; 'dec_Referral'(Data);</font>
<font color=red>     0..|  decode_disp('LDAPURL',Data) -&gt; 'dec_LDAPURL'(Data);</font>
<font color=red>     0..|  decode_disp('Controls',Data) -&gt; 'dec_Controls'(Data);</font>
<font color=red>     0..|  decode_disp('Control',Data) -&gt; 'dec_Control'(Data);</font>
<font color=red>     0..|  decode_disp('BindRequest',Data) -&gt; 'dec_BindRequest'(Data);</font>
<font color=red>     0..|  decode_disp('AuthenticationChoice',Data) -&gt; 'dec_AuthenticationChoice'(Data);</font>
<font color=red>     0..|  decode_disp('SaslCredentials',Data) -&gt; 'dec_SaslCredentials'(Data);</font>
<font color=red>     0..|  decode_disp('BindResponse',Data) -&gt; 'dec_BindResponse'(Data);</font>
<font color=red>     0..|  decode_disp('UnbindRequest',Data) -&gt; 'dec_UnbindRequest'(Data);</font>
<font color=red>     0..|  decode_disp('SearchRequest',Data) -&gt; 'dec_SearchRequest'(Data);</font>
<font color=red>     0..|  decode_disp('Filter',Data) -&gt; 'dec_Filter'(Data);</font>
<font color=red>     0..|  decode_disp('SubstringFilter',Data) -&gt; 'dec_SubstringFilter'(Data);</font>
<font color=red>     0..|  decode_disp('MatchingRuleAssertion',Data) -&gt; 'dec_MatchingRuleAssertion'(Data);</font>
<font color=red>     0..|  decode_disp('SearchResultEntry',Data) -&gt; 'dec_SearchResultEntry'(Data);</font>
<font color=red>     0..|  decode_disp('PartialAttributeList',Data) -&gt; 'dec_PartialAttributeList'(Data);</font>
<font color=red>     0..|  decode_disp('SearchResultReference',Data) -&gt; 'dec_SearchResultReference'(Data);</font>
<font color=red>     0..|  decode_disp('SearchResultDone',Data) -&gt; 'dec_SearchResultDone'(Data);</font>
<font color=red>     0..|  decode_disp('ModifyRequest',Data) -&gt; 'dec_ModifyRequest'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeTypeAndValues',Data) -&gt; 'dec_AttributeTypeAndValues'(Data);</font>
<font color=red>     0..|  decode_disp('ModifyResponse',Data) -&gt; 'dec_ModifyResponse'(Data);</font>
<font color=red>     0..|  decode_disp('AddRequest',Data) -&gt; 'dec_AddRequest'(Data);</font>
<font color=red>     0..|  decode_disp('AttributeList',Data) -&gt; 'dec_AttributeList'(Data);</font>
<font color=red>     0..|  decode_disp('AddResponse',Data) -&gt; 'dec_AddResponse'(Data);</font>
<font color=red>     0..|  decode_disp('DelRequest',Data) -&gt; 'dec_DelRequest'(Data);</font>
<font color=red>     0..|  decode_disp('DelResponse',Data) -&gt; 'dec_DelResponse'(Data);</font>
<font color=red>     0..|  decode_disp('ModifyDNRequest',Data) -&gt; 'dec_ModifyDNRequest'(Data);</font>
<font color=red>     0..|  decode_disp('ModifyDNResponse',Data) -&gt; 'dec_ModifyDNResponse'(Data);</font>
<font color=red>     0..|  decode_disp('CompareRequest',Data) -&gt; 'dec_CompareRequest'(Data);</font>
<font color=red>     0..|  decode_disp('CompareResponse',Data) -&gt; 'dec_CompareResponse'(Data);</font>
<font color=red>     0..|  decode_disp('AbandonRequest',Data) -&gt; 'dec_AbandonRequest'(Data);</font>
<font color=red>     0..|  decode_disp('ExtendedRequest',Data) -&gt; 'dec_ExtendedRequest'(Data);</font>
<font color=red>     0..|  decode_disp('ExtendedResponse',Data) -&gt; 'dec_ExtendedResponse'(Data);</font>
<font color=red>     0..|  decode_disp('PasswdModifyRequestValue',Data) -&gt; 'dec_PasswdModifyRequestValue'(Data);</font>
<font color=red>     0..|  decode_disp('PasswdModifyResponseValue',Data) -&gt; 'dec_PasswdModifyResponseValue'(Data);</font>
<font color=red>     0..|  decode_disp(Type,_Data) -&gt; exit({error,{asn1,{undefined_type,Type}}}).</font>
        |  
        |  
        |  
        |  
        |  info() -&gt;
<font color=red>     0..|     case ?MODULE:module_info(attributes) of</font>
        |       Attributes when is_list(Attributes) -&gt;
<font color=red>     0..|         case lists:keyfind(asn1_info, 1, Attributes) of</font>
        |           {_,Info} when is_list(Info) -&gt;
<font color=red>     0..|             Info;</font>
        |           _ -&gt;
<font color=red>     0..|             []</font>
        |         end;
        |       _ -&gt;
<font color=red>     0..|         []</font>
        |     end.
        |  
        |  
        |  %%================================
        |  %%  LDAPMessage
        |  %%================================
        |  'enc_LDAPMessage'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPMessage'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_LDAPMessage'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute messageID(1) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_integer(Cindex1, [&lt;&lt;2&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute protocolOp(2) with type CHOICE
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_LDAPMessage_protocolOp'(Cindex2, []),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute controls(3)   External ELDAPv3:Controls OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} =  case Cindex3 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              'enc_Controls'(Cindex3, [&lt;&lt;160&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPMessage_protocolOp
        |  %%================================
        |  'enc_LDAPMessage_protocolOp'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = case element(1,Val) of</font>
        |        bindRequest -&gt;
<font color=red>     0..|           'enc_BindRequest'(element(2,Val), [&lt;&lt;96&gt;&gt;]);</font>
        |        bindResponse -&gt;
<font color=red>     0..|           'enc_BindResponse'(element(2,Val), [&lt;&lt;97&gt;&gt;]);</font>
        |        unbindRequest -&gt;
<font color=red>     0..|           encode_null(element(2,Val), [&lt;&lt;66&gt;&gt;]);</font>
        |        searchRequest -&gt;
<font color=red>     0..|           'enc_SearchRequest'(element(2,Val), [&lt;&lt;99&gt;&gt;]);</font>
        |        searchResEntry -&gt;
<font color=red>     0..|           'enc_SearchResultEntry'(element(2,Val), [&lt;&lt;100&gt;&gt;]);</font>
        |        searchResDone -&gt;
<font color=red>     0..|           'enc_SearchResultDone'(element(2,Val), [&lt;&lt;101&gt;&gt;]);</font>
        |        searchResRef -&gt;
<font color=red>     0..|           'enc_SearchResultReference'(element(2,Val), [&lt;&lt;115&gt;&gt;]);</font>
        |        modifyRequest -&gt;
<font color=red>     0..|           'enc_ModifyRequest'(element(2,Val), [&lt;&lt;102&gt;&gt;]);</font>
        |        modifyResponse -&gt;
<font color=red>     0..|           'enc_ModifyResponse'(element(2,Val), [&lt;&lt;103&gt;&gt;]);</font>
        |        addRequest -&gt;
<font color=red>     0..|           'enc_AddRequest'(element(2,Val), [&lt;&lt;104&gt;&gt;]);</font>
        |        addResponse -&gt;
<font color=red>     0..|           'enc_AddResponse'(element(2,Val), [&lt;&lt;105&gt;&gt;]);</font>
        |        delRequest -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;74&gt;&gt;]);</font>
        |        delResponse -&gt;
<font color=red>     0..|           'enc_DelResponse'(element(2,Val), [&lt;&lt;107&gt;&gt;]);</font>
        |        modDNRequest -&gt;
<font color=red>     0..|           'enc_ModifyDNRequest'(element(2,Val), [&lt;&lt;108&gt;&gt;]);</font>
        |        modDNResponse -&gt;
<font color=red>     0..|           'enc_ModifyDNResponse'(element(2,Val), [&lt;&lt;109&gt;&gt;]);</font>
        |        compareRequest -&gt;
<font color=red>     0..|           'enc_CompareRequest'(element(2,Val), [&lt;&lt;110&gt;&gt;]);</font>
        |        compareResponse -&gt;
<font color=red>     0..|           'enc_CompareResponse'(element(2,Val), [&lt;&lt;111&gt;&gt;]);</font>
        |        abandonRequest -&gt;
<font color=red>     0..|           encode_integer(element(2,Val), [&lt;&lt;80&gt;&gt;]);</font>
        |        extendedReq -&gt;
<font color=red>     0..|           'enc_ExtendedRequest'(element(2,Val), [&lt;&lt;119&gt;&gt;]);</font>
        |        extendedResp -&gt;
<font color=red>     0..|           'enc_ExtendedResponse'(element(2,Val), [&lt;&lt;120&gt;&gt;]);</font>
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_type,Else}}})</font>
        |     end,
        |  
<font color=red>     0..|  encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  
        |  'dec_LDAPMessage_protocolOp'(Tlv, TagIn) -&gt;
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  case (case Tlv1 of [CtempTlv1] -&gt; CtempTlv1; _ -&gt; Tlv1 end) of</font>
        |  
        |  %% 'bindRequest'
        |      {65536, V1} -&gt; 
<font color=red>     0..|          {bindRequest, 'dec_BindRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'bindResponse'
        |      {65537, V1} -&gt; 
<font color=red>     0..|          {bindResponse, 'dec_BindResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'unbindRequest'
        |      {65538, V1} -&gt; 
<font color=red>     0..|          {unbindRequest, decode_null(V1, [])};</font>
        |  
        |  
        |  %% 'searchRequest'
        |      {65539, V1} -&gt; 
<font color=red>     0..|          {searchRequest, 'dec_SearchRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'searchResEntry'
        |      {65540, V1} -&gt; 
<font color=red>     0..|          {searchResEntry, 'dec_SearchResultEntry'(V1, [])};</font>
        |  
        |  
        |  %% 'searchResDone'
        |      {65541, V1} -&gt; 
<font color=red>     0..|          {searchResDone, 'dec_SearchResultDone'(V1, [])};</font>
        |  
        |  
        |  %% 'searchResRef'
        |      {65555, V1} -&gt; 
<font color=red>     0..|          {searchResRef, 'dec_SearchResultReference'(V1, [])};</font>
        |  
        |  
        |  %% 'modifyRequest'
        |      {65542, V1} -&gt; 
<font color=red>     0..|          {modifyRequest, 'dec_ModifyRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'modifyResponse'
        |      {65543, V1} -&gt; 
<font color=red>     0..|          {modifyResponse, 'dec_ModifyResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'addRequest'
        |      {65544, V1} -&gt; 
<font color=red>     0..|          {addRequest, 'dec_AddRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'addResponse'
        |      {65545, V1} -&gt; 
<font color=red>     0..|          {addResponse, 'dec_AddResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'delRequest'
        |      {65546, V1} -&gt; 
<font color=red>     0..|          {delRequest, decode_octet_string(V1, [])};</font>
        |  
        |  
        |  %% 'delResponse'
        |      {65547, V1} -&gt; 
<font color=red>     0..|          {delResponse, 'dec_DelResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'modDNRequest'
        |      {65548, V1} -&gt; 
<font color=red>     0..|          {modDNRequest, 'dec_ModifyDNRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'modDNResponse'
        |      {65549, V1} -&gt; 
<font color=red>     0..|          {modDNResponse, 'dec_ModifyDNResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'compareRequest'
        |      {65550, V1} -&gt; 
<font color=red>     0..|          {compareRequest, 'dec_CompareRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'compareResponse'
        |      {65551, V1} -&gt; 
<font color=red>     0..|          {compareResponse, 'dec_CompareResponse'(V1, [])};</font>
        |  
        |  
        |  %% 'abandonRequest'
        |      {65552, V1} -&gt; 
<font color=red>     0..|          {abandonRequest, begin</font>
<font color=red>     0..|  Val1 = decode_integer(V1, []),</font>
<font color=red>     0..|  if 0 =&lt; Val1, Val1 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end};
        |  
        |  
        |  %% 'extendedReq'
        |      {65559, V1} -&gt; 
<font color=red>     0..|          {extendedReq, 'dec_ExtendedRequest'(V1, [])};</font>
        |  
        |  
        |  %% 'extendedResp'
        |      {65560, V1} -&gt; 
<font color=red>     0..|          {extendedResp, 'dec_ExtendedResponse'(V1, [])};</font>
        |  
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_tag,Else}}})</font>
        |     end
        |  .
        |  
        |  
        |  'dec_LDAPMessage'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPMessage'(Tlv, [16]).</font>
        |  
        |  'dec_LDAPMessage'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute messageID(1) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = begin</font>
<font color=red>     0..|  Val1 = decode_integer(V1, [2]),</font>
<font color=red>     0..|  if 0 =&lt; Val1, Val1 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute protocolOp(2) with type CHOICE
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_LDAPMessage_protocolOp'(V2, []),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute controls(3)   External ELDAPv3:Controls OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term3,Tlv4} = case Tlv3 of</font>
        |  [{131072,V3}|TempTlv4] -&gt;
<font color=red>     0..|      {'dec_Controls'(V3, []), TempTlv4};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv3}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv4 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv4}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'LDAPMessage', Term1, Term2, Term3}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  MessageID
        |  %%================================
        |  'enc_MessageID'(Val) -&gt;
<font color=red>     0..|      'enc_MessageID'(Val, [&lt;&lt;2&gt;&gt;]).</font>
        |  
        |  'enc_MessageID'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_integer(Val, TagIn).</font>
        |  
        |  
        |  'dec_MessageID'(Tlv) -&gt;
<font color=red>     0..|     'dec_MessageID'(Tlv, [2]).</font>
        |  
        |  'dec_MessageID'(Tlv, TagIn) -&gt;
<font color=red>     0..|  begin</font>
<font color=red>     0..|  Val1 = decode_integer(Tlv, TagIn),</font>
<font color=red>     0..|  if 0 =&lt; Val1, Val1 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end.
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPString
        |  %%================================
        |  'enc_LDAPString'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPString'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_LDAPString'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_LDAPString'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPString'(Tlv, [4]).</font>
        |  
        |  'dec_LDAPString'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPOID
        |  %%================================
        |  'enc_LDAPOID'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPOID'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_LDAPOID'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_LDAPOID'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPOID'(Tlv, [4]).</font>
        |  
        |  'dec_LDAPOID'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPDN
        |  %%================================
        |  'enc_LDAPDN'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPDN'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_LDAPDN'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_LDAPDN'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPDN'(Tlv, [4]).</font>
        |  
        |  'dec_LDAPDN'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  RelativeLDAPDN
        |  %%================================
        |  'enc_RelativeLDAPDN'(Val) -&gt;
<font color=red>     0..|      'enc_RelativeLDAPDN'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_RelativeLDAPDN'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_RelativeLDAPDN'(Tlv) -&gt;
<font color=red>     0..|     'dec_RelativeLDAPDN'(Tlv, [4]).</font>
        |  
        |  'dec_RelativeLDAPDN'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeType
        |  %%================================
        |  'enc_AttributeType'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeType'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_AttributeType'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_AttributeType'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeType'(Tlv, [4]).</font>
        |  
        |  'dec_AttributeType'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeDescription
        |  %%================================
        |  'enc_AttributeDescription'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeDescription'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_AttributeDescription'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_AttributeDescription'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeDescription'(Tlv, [4]).</font>
        |  
        |  'dec_AttributeDescription'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeDescriptionList
        |  %%================================
        |  'enc_AttributeDescriptionList'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeDescriptionList'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_AttributeDescriptionList'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_AttributeDescriptionList_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_AttributeDescriptionList_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_AttributeDescriptionList_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_AttributeDescriptionList_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  'dec_AttributeDescriptionList'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeDescriptionList'(Tlv, [16]).</font>
        |  
        |  'dec_AttributeDescriptionList'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeValue
        |  %%================================
        |  'enc_AttributeValue'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeValue'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_AttributeValue'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_AttributeValue'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeValue'(Tlv, [4]).</font>
        |  
        |  'dec_AttributeValue'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeValueAssertion
        |  %%================================
        |  'enc_AttributeValueAssertion'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeValueAssertion'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_AttributeValueAssertion'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributeDesc(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute assertionValue(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_AttributeValueAssertion'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeValueAssertion'(Tlv, [16]).</font>
        |  
        |  'dec_AttributeValueAssertion'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributeDesc(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute assertionValue(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'AttributeValueAssertion', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AssertionValue
        |  %%================================
        |  'enc_AssertionValue'(Val) -&gt;
<font color=red>     0..|      'enc_AssertionValue'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_AssertionValue'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_AssertionValue'(Tlv) -&gt;
<font color=red>     0..|     'dec_AssertionValue'(Tlv, [4]).</font>
        |  
        |  'dec_AssertionValue'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  Attribute
        |  %%================================
        |  'enc_Attribute'(Val) -&gt;
<font color=red>     0..|      'enc_Attribute'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_Attribute'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_Attribute_vals'(Cindex2, [&lt;&lt;49&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  Attribute_vals
        |  %%================================
        |  'enc_Attribute_vals'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_Attribute_vals_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_Attribute_vals_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_Attribute_vals_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_Attribute_vals_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_Attribute_vals'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  'dec_Attribute'(Tlv) -&gt;
<font color=red>     0..|     'dec_Attribute'(Tlv, [16]).</font>
        |  
        |  'dec_Attribute'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_Attribute_vals'(V2, [17]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'Attribute', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  MatchingRuleId
        |  %%================================
        |  'enc_MatchingRuleId'(Val) -&gt;
<font color=red>     0..|      'enc_MatchingRuleId'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_MatchingRuleId'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_MatchingRuleId'(Tlv) -&gt;
<font color=red>     0..|     'dec_MatchingRuleId'(Tlv, [4]).</font>
        |  
        |  'dec_MatchingRuleId'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPResult
        |  %%================================
        |  'enc_LDAPResult'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPResult'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_LDAPResult'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = case Cindex1 of</font>
<font color=red>     0..|  success -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  operationsError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  protocolError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  timeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [3], 1);</font>
<font color=red>     0..|  sizeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [4], 1);</font>
<font color=red>     0..|  compareFalse -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [5], 1);</font>
<font color=red>     0..|  compareTrue -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [6], 1);</font>
<font color=red>     0..|  authMethodNotSupported -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [7], 1);</font>
<font color=red>     0..|  strongAuthRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [8], 1);</font>
<font color=red>     0..|  referral -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [10], 1);</font>
<font color=red>     0..|  adminLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [11], 1);</font>
<font color=red>     0..|  unavailableCriticalExtension -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [12], 1);</font>
<font color=red>     0..|  confidentialityRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [13], 1);</font>
<font color=red>     0..|  saslBindInProgress -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [14], 1);</font>
<font color=red>     0..|  noSuchAttribute -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [16], 1);</font>
<font color=red>     0..|  undefinedAttributeType -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [17], 1);</font>
<font color=red>     0..|  inappropriateMatching -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [18], 1);</font>
<font color=red>     0..|  constraintViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [19], 1);</font>
<font color=red>     0..|  attributeOrValueExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [20], 1);</font>
<font color=red>     0..|  invalidAttributeSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [21], 1);</font>
<font color=red>     0..|  noSuchObject -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [32], 1);</font>
<font color=red>     0..|  aliasProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [33], 1);</font>
<font color=red>     0..|  invalidDNSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [34], 1);</font>
<font color=red>     0..|  aliasDereferencingProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [36], 1);</font>
<font color=red>     0..|  inappropriateAuthentication -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [48], 1);</font>
<font color=red>     0..|  invalidCredentials -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [49], 1);</font>
<font color=red>     0..|  insufficientAccessRights -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [50], 1);</font>
<font color=red>     0..|  busy -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [51], 1);</font>
<font color=red>     0..|  unavailable -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [52], 1);</font>
<font color=red>     0..|  unwillingToPerform -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [53], 1);</font>
<font color=red>     0..|  loopDetect -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [54], 1);</font>
<font color=red>     0..|  namingViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [64], 1);</font>
<font color=red>     0..|  objectClassViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [65], 1);</font>
<font color=red>     0..|  notAllowedOnNonLeaf -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [66], 1);</font>
<font color=red>     0..|  notAllowedOnRDN -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [67], 1);</font>
<font color=red>     0..|  entryAlreadyExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [68], 1);</font>
<font color=red>     0..|  objectClassModsProhibited -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [69], 1);</font>
<font color=red>     0..|  affectsMultipleDSAs -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [71], 1);</font>
<font color=red>     0..|  other -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [80], 1);</font>
<font color=red>     0..|  Enumval1 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = encode_restricted_string(Cindex3, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} =  case Cindex4 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              'enc_Referral'(Cindex4, [&lt;&lt;163&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_LDAPResult'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPResult'(Tlv, [16]).</font>
        |  
        |  'dec_LDAPResult'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = case decode_integer(V1, [10]) of</font>
<font color=red>     0..|  0 -&gt; success;</font>
<font color=red>     0..|  1 -&gt; operationsError;</font>
<font color=red>     0..|  2 -&gt; protocolError;</font>
<font color=red>     0..|  3 -&gt; timeLimitExceeded;</font>
<font color=red>     0..|  4 -&gt; sizeLimitExceeded;</font>
<font color=red>     0..|  5 -&gt; compareFalse;</font>
<font color=red>     0..|  6 -&gt; compareTrue;</font>
<font color=red>     0..|  7 -&gt; authMethodNotSupported;</font>
<font color=red>     0..|  8 -&gt; strongAuthRequired;</font>
<font color=red>     0..|  10 -&gt; referral;</font>
<font color=red>     0..|  11 -&gt; adminLimitExceeded;</font>
<font color=red>     0..|  12 -&gt; unavailableCriticalExtension;</font>
<font color=red>     0..|  13 -&gt; confidentialityRequired;</font>
<font color=red>     0..|  14 -&gt; saslBindInProgress;</font>
<font color=red>     0..|  16 -&gt; noSuchAttribute;</font>
<font color=red>     0..|  17 -&gt; undefinedAttributeType;</font>
<font color=red>     0..|  18 -&gt; inappropriateMatching;</font>
<font color=red>     0..|  19 -&gt; constraintViolation;</font>
<font color=red>     0..|  20 -&gt; attributeOrValueExists;</font>
<font color=red>     0..|  21 -&gt; invalidAttributeSyntax;</font>
<font color=red>     0..|  32 -&gt; noSuchObject;</font>
<font color=red>     0..|  33 -&gt; aliasProblem;</font>
<font color=red>     0..|  34 -&gt; invalidDNSyntax;</font>
<font color=red>     0..|  36 -&gt; aliasDereferencingProblem;</font>
<font color=red>     0..|  48 -&gt; inappropriateAuthentication;</font>
<font color=red>     0..|  49 -&gt; invalidCredentials;</font>
<font color=red>     0..|  50 -&gt; insufficientAccessRights;</font>
<font color=red>     0..|  51 -&gt; busy;</font>
<font color=red>     0..|  52 -&gt; unavailable;</font>
<font color=red>     0..|  53 -&gt; unwillingToPerform;</font>
<font color=red>     0..|  54 -&gt; loopDetect;</font>
<font color=red>     0..|  64 -&gt; namingViolation;</font>
<font color=red>     0..|  65 -&gt; objectClassViolation;</font>
<font color=red>     0..|  66 -&gt; notAllowedOnNonLeaf;</font>
<font color=red>     0..|  67 -&gt; notAllowedOnRDN;</font>
<font color=red>     0..|  68 -&gt; entryAlreadyExists;</font>
<font color=red>     0..|  69 -&gt; objectClassModsProhibited;</font>
<font color=red>     0..|  71 -&gt; affectsMultipleDSAs;</font>
<font color=red>     0..|  80 -&gt; other;</font>
<font color=red>     0..|  Default1 -&gt; exit({error,{asn1,{illegal_enumerated,Default1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = decode_octet_string(V3, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term4,Tlv5} = case Tlv4 of</font>
        |  [{131075,V4}|TempTlv5] -&gt;
<font color=red>     0..|      {'dec_Referral'(V4, []), TempTlv5};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv4}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv5 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv5}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'LDAPResult', Term1, Term2, Term3, Term4}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  Referral
        |  %%================================
        |  'enc_Referral'(Val) -&gt;
<font color=red>     0..|      'enc_Referral'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_Referral'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_Referral_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_Referral_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_Referral_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_Referral_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  'dec_Referral'(Tlv) -&gt;
<font color=red>     0..|     'dec_Referral'(Tlv, [16]).</font>
        |  
        |  'dec_Referral'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  LDAPURL
        |  %%================================
        |  'enc_LDAPURL'(Val) -&gt;
<font color=red>     0..|      'enc_LDAPURL'(Val, [&lt;&lt;4&gt;&gt;]).</font>
        |  
        |  'enc_LDAPURL'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_LDAPURL'(Tlv) -&gt;
<font color=red>     0..|     'dec_LDAPURL'(Tlv, [4]).</font>
        |  
        |  'dec_LDAPURL'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  Controls
        |  %%================================
        |  'enc_Controls'(Val) -&gt;
<font color=red>     0..|      'enc_Controls'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_Controls'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_Controls_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_Controls_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_Controls_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_Control'(H, [&lt;&lt;48&gt;&gt;]),</font>
<font color=red>     0..|     'enc_Controls_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  'dec_Controls'(Tlv) -&gt;
<font color=red>     0..|     'dec_Controls'(Tlv, [16]).</font>
        |  
        |  'dec_Controls'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_Control'(V1, [16]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  Control
        |  %%================================
        |  'enc_Control'(Val) -&gt;
<font color=red>     0..|      'enc_Control'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_Control'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute controlType(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute criticality(2) with type BOOLEAN DEFAULT = false
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} =  case Cindex2 of</font>
<font color=red>     0..|           asn1_DEFAULT -&gt; {&lt;&lt;&gt;&gt;,0};</font>
<font color=red>     0..|           false -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_boolean(Cindex2, [&lt;&lt;1&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute controlValue(3) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} =  case Cindex3 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex3, [&lt;&lt;4&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_Control'(Tlv) -&gt;
<font color=red>     0..|     'dec_Control'(Tlv, [16]).</font>
        |  
        |  'dec_Control'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute controlType(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute criticality(2) with type BOOLEAN DEFAULT = false
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term2,Tlv3} = case Tlv2 of</font>
        |  [{1,V2}|TempTlv3] -&gt;
<font color=red>     0..|      {decode_boolean(V2, []), TempTlv3};</font>
        |      _ -&gt;
<font color=red>     0..|          {false,Tlv2}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute controlValue(3) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term3,Tlv4} = case Tlv3 of</font>
        |  [{4,V3}|TempTlv4] -&gt;
<font color=red>     0..|      {decode_octet_string(V3, []), TempTlv4};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv3}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv4 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv4}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'Control', Term1, Term2, Term3}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  BindRequest
        |  %%================================
        |  'enc_BindRequest'(Val) -&gt;
<font color=red>     0..|      'enc_BindRequest'(Val, [&lt;&lt;96&gt;&gt;]).</font>
        |  
        |  'enc_BindRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute version(1) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_integer(Cindex1, [&lt;&lt;2&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute name(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute authentication(3)   External ELDAPv3:AuthenticationChoice
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = 'enc_AuthenticationChoice'(Cindex3, []),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_BindRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_BindRequest'(Tlv, [65536]).</font>
        |  
        |  'dec_BindRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute version(1) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = begin</font>
<font color=red>     0..|  Val1 = decode_integer(V1, [2]),</font>
<font color=red>     0..|  if 1 =&lt; Val1, Val1 =&lt; 127 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute name(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute authentication(3)   External ELDAPv3:AuthenticationChoice
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = 'dec_AuthenticationChoice'(V3, []),</font>
        |  
<font color=red>     0..|  case Tlv4 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv4}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'BindRequest', Term1, Term2, Term3}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AuthenticationChoice
        |  %%================================
        |  'enc_AuthenticationChoice'(Val) -&gt;
<font color=red>     0..|      'enc_AuthenticationChoice'(Val, []).</font>
        |  
        |  'enc_AuthenticationChoice'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = case element(1,Val) of</font>
        |        simple -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;128&gt;&gt;]);</font>
        |        sasl -&gt;
<font color=red>     0..|           'enc_SaslCredentials'(element(2,Val), [&lt;&lt;163&gt;&gt;]);</font>
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_type,Else}}})</font>
        |     end,
        |  
<font color=red>     0..|  encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  
        |  
        |  
        |  'dec_AuthenticationChoice'(Tlv) -&gt;
<font color=red>     0..|     'dec_AuthenticationChoice'(Tlv, []).</font>
        |  
        |  'dec_AuthenticationChoice'(Tlv, TagIn) -&gt;
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  case (case Tlv1 of [CtempTlv1] -&gt; CtempTlv1; _ -&gt; Tlv1 end) of</font>
        |  
        |  %% 'simple'
        |      {131072, V1} -&gt; 
<font color=red>     0..|          {simple, decode_octet_string(V1, [])};</font>
        |  
        |  
        |  %% 'sasl'
        |      {131075, V1} -&gt; 
<font color=red>     0..|          {sasl, 'dec_SaslCredentials'(V1, [])};</font>
        |  
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_tag,Else}}})</font>
        |     end
        |  .
        |  
        |  
        |  %%================================
        |  %%  SaslCredentials
        |  %%================================
        |  'enc_SaslCredentials'(Val) -&gt;
<font color=red>     0..|      'enc_SaslCredentials'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_SaslCredentials'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute mechanism(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute credentials(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} =  case Cindex2 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_SaslCredentials'(Tlv) -&gt;
<font color=red>     0..|     'dec_SaslCredentials'(Tlv, [16]).</font>
        |  
        |  'dec_SaslCredentials'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute mechanism(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute credentials(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term2,Tlv3} = case Tlv2 of</font>
        |  [{4,V2}|TempTlv3] -&gt;
<font color=red>     0..|      {decode_octet_string(V2, []), TempTlv3};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv2}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'SaslCredentials', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  BindResponse
        |  %%================================
        |  'enc_BindResponse'(Val) -&gt;
<font color=red>     0..|      'enc_BindResponse'(Val, [&lt;&lt;97&gt;&gt;]).</font>
        |  
        |  'enc_BindResponse'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4, Cindex5} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = case Cindex1 of</font>
<font color=red>     0..|  success -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  operationsError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  protocolError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  timeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [3], 1);</font>
<font color=red>     0..|  sizeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [4], 1);</font>
<font color=red>     0..|  compareFalse -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [5], 1);</font>
<font color=red>     0..|  compareTrue -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [6], 1);</font>
<font color=red>     0..|  authMethodNotSupported -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [7], 1);</font>
<font color=red>     0..|  strongAuthRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [8], 1);</font>
<font color=red>     0..|  referral -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [10], 1);</font>
<font color=red>     0..|  adminLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [11], 1);</font>
<font color=red>     0..|  unavailableCriticalExtension -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [12], 1);</font>
<font color=red>     0..|  confidentialityRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [13], 1);</font>
<font color=red>     0..|  saslBindInProgress -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [14], 1);</font>
<font color=red>     0..|  noSuchAttribute -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [16], 1);</font>
<font color=red>     0..|  undefinedAttributeType -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [17], 1);</font>
<font color=red>     0..|  inappropriateMatching -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [18], 1);</font>
<font color=red>     0..|  constraintViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [19], 1);</font>
<font color=red>     0..|  attributeOrValueExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [20], 1);</font>
<font color=red>     0..|  invalidAttributeSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [21], 1);</font>
<font color=red>     0..|  noSuchObject -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [32], 1);</font>
<font color=red>     0..|  aliasProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [33], 1);</font>
<font color=red>     0..|  invalidDNSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [34], 1);</font>
<font color=red>     0..|  aliasDereferencingProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [36], 1);</font>
<font color=red>     0..|  inappropriateAuthentication -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [48], 1);</font>
<font color=red>     0..|  invalidCredentials -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [49], 1);</font>
<font color=red>     0..|  insufficientAccessRights -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [50], 1);</font>
<font color=red>     0..|  busy -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [51], 1);</font>
<font color=red>     0..|  unavailable -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [52], 1);</font>
<font color=red>     0..|  unwillingToPerform -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [53], 1);</font>
<font color=red>     0..|  loopDetect -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [54], 1);</font>
<font color=red>     0..|  namingViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [64], 1);</font>
<font color=red>     0..|  objectClassViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [65], 1);</font>
<font color=red>     0..|  notAllowedOnNonLeaf -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [66], 1);</font>
<font color=red>     0..|  notAllowedOnRDN -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [67], 1);</font>
<font color=red>     0..|  entryAlreadyExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [68], 1);</font>
<font color=red>     0..|  objectClassModsProhibited -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [69], 1);</font>
<font color=red>     0..|  affectsMultipleDSAs -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [71], 1);</font>
<font color=red>     0..|  other -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [80], 1);</font>
<font color=red>     0..|  Enumval1 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = encode_restricted_string(Cindex3, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} =  case Cindex4 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              'enc_Referral'(Cindex4, [&lt;&lt;163&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute serverSaslCreds(5) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes5,EncLen5} =  case Cindex5 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex5, [&lt;&lt;135&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4, EncBytes5],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4 + EncLen5,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_BindResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_BindResponse'(Tlv, [65537]).</font>
        |  
        |  'dec_BindResponse'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = case decode_integer(V1, [10]) of</font>
<font color=red>     0..|  0 -&gt; success;</font>
<font color=red>     0..|  1 -&gt; operationsError;</font>
<font color=red>     0..|  2 -&gt; protocolError;</font>
<font color=red>     0..|  3 -&gt; timeLimitExceeded;</font>
<font color=red>     0..|  4 -&gt; sizeLimitExceeded;</font>
<font color=red>     0..|  5 -&gt; compareFalse;</font>
<font color=red>     0..|  6 -&gt; compareTrue;</font>
<font color=red>     0..|  7 -&gt; authMethodNotSupported;</font>
<font color=red>     0..|  8 -&gt; strongAuthRequired;</font>
<font color=red>     0..|  10 -&gt; referral;</font>
<font color=red>     0..|  11 -&gt; adminLimitExceeded;</font>
<font color=red>     0..|  12 -&gt; unavailableCriticalExtension;</font>
<font color=red>     0..|  13 -&gt; confidentialityRequired;</font>
<font color=red>     0..|  14 -&gt; saslBindInProgress;</font>
<font color=red>     0..|  16 -&gt; noSuchAttribute;</font>
<font color=red>     0..|  17 -&gt; undefinedAttributeType;</font>
<font color=red>     0..|  18 -&gt; inappropriateMatching;</font>
<font color=red>     0..|  19 -&gt; constraintViolation;</font>
<font color=red>     0..|  20 -&gt; attributeOrValueExists;</font>
<font color=red>     0..|  21 -&gt; invalidAttributeSyntax;</font>
<font color=red>     0..|  32 -&gt; noSuchObject;</font>
<font color=red>     0..|  33 -&gt; aliasProblem;</font>
<font color=red>     0..|  34 -&gt; invalidDNSyntax;</font>
<font color=red>     0..|  36 -&gt; aliasDereferencingProblem;</font>
<font color=red>     0..|  48 -&gt; inappropriateAuthentication;</font>
<font color=red>     0..|  49 -&gt; invalidCredentials;</font>
<font color=red>     0..|  50 -&gt; insufficientAccessRights;</font>
<font color=red>     0..|  51 -&gt; busy;</font>
<font color=red>     0..|  52 -&gt; unavailable;</font>
<font color=red>     0..|  53 -&gt; unwillingToPerform;</font>
<font color=red>     0..|  54 -&gt; loopDetect;</font>
<font color=red>     0..|  64 -&gt; namingViolation;</font>
<font color=red>     0..|  65 -&gt; objectClassViolation;</font>
<font color=red>     0..|  66 -&gt; notAllowedOnNonLeaf;</font>
<font color=red>     0..|  67 -&gt; notAllowedOnRDN;</font>
<font color=red>     0..|  68 -&gt; entryAlreadyExists;</font>
<font color=red>     0..|  69 -&gt; objectClassModsProhibited;</font>
<font color=red>     0..|  71 -&gt; affectsMultipleDSAs;</font>
<font color=red>     0..|  80 -&gt; other;</font>
<font color=red>     0..|  Default1 -&gt; exit({error,{asn1,{illegal_enumerated,Default1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = decode_octet_string(V3, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term4,Tlv5} = case Tlv4 of</font>
        |  [{131075,V4}|TempTlv5] -&gt;
<font color=red>     0..|      {'dec_Referral'(V4, []), TempTlv5};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv4}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute serverSaslCreds(5) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term5,Tlv6} = case Tlv5 of</font>
        |  [{131079,V5}|TempTlv6] -&gt;
<font color=red>     0..|      {decode_octet_string(V5, []), TempTlv6};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv5}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv6 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv6}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'BindResponse', Term1, Term2, Term3, Term4, Term5}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  UnbindRequest
        |  %%================================
        |  'enc_UnbindRequest'(Val) -&gt;
<font color=red>     0..|      'enc_UnbindRequest'(Val, [&lt;&lt;66&gt;&gt;]).</font>
        |  
        |  'enc_UnbindRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_null(Val, TagIn).</font>
        |  
        |  
        |  'dec_UnbindRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_UnbindRequest'(Tlv, [65538]).</font>
        |  
        |  'dec_UnbindRequest'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_null(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  SearchRequest
        |  %%================================
        |  'enc_SearchRequest'(Val) -&gt;
<font color=red>     0..|      'enc_SearchRequest'(Val, [&lt;&lt;99&gt;&gt;]).</font>
        |  
        |  'enc_SearchRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4, Cindex5, Cindex6, Cindex7, Cindex8} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute baseObject(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute scope(2) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = case Cindex2 of</font>
<font color=red>     0..|  baseObject -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  singleLevel -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  wholeSubtree -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  Enumval2 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval2}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute derefAliases(3) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = case Cindex3 of</font>
<font color=red>     0..|  neverDerefAliases -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  derefInSearching -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  derefFindingBaseObj -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  derefAlways -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [3], 1);</font>
<font color=red>     0..|  Enumval3 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval3}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute sizeLimit(4) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} = encode_integer(Cindex4, [&lt;&lt;2&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute timeLimit(5) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes5,EncLen5} = encode_integer(Cindex5, [&lt;&lt;2&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute typesOnly(6) with type BOOLEAN
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes6,EncLen6} = encode_boolean(Cindex6, [&lt;&lt;1&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute filter(7)   External ELDAPv3:Filter
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes7,EncLen7} = 'enc_Filter'(Cindex7, []),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(8)   External ELDAPv3:AttributeDescriptionList
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes8,EncLen8} = 'enc_AttributeDescriptionList'(Cindex8, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4, EncBytes5, EncBytes6, EncBytes7, EncBytes8],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4 + EncLen5 + EncLen6 + EncLen7 + EncLen8,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_SearchRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_SearchRequest'(Tlv, [65539]).</font>
        |  
        |  'dec_SearchRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute baseObject(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute scope(2) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = case decode_integer(V2, [10]) of</font>
<font color=red>     0..|  0 -&gt; baseObject;</font>
<font color=red>     0..|  1 -&gt; singleLevel;</font>
<font color=red>     0..|  2 -&gt; wholeSubtree;</font>
<font color=red>     0..|  Default1 -&gt; exit({error,{asn1,{illegal_enumerated,Default1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute derefAliases(3) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = case decode_integer(V3, [10]) of</font>
<font color=red>     0..|  0 -&gt; neverDerefAliases;</font>
<font color=red>     0..|  1 -&gt; derefInSearching;</font>
<font color=red>     0..|  2 -&gt; derefFindingBaseObj;</font>
<font color=red>     0..|  3 -&gt; derefAlways;</font>
<font color=red>     0..|  Default2 -&gt; exit({error,{asn1,{illegal_enumerated,Default2}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute sizeLimit(4) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|  [V4|Tlv5] = Tlv4, </font>
<font color=red>     0..|  Term4 = begin</font>
<font color=red>     0..|  Val1 = decode_integer(V4, [2]),</font>
<font color=red>     0..|  if 0 =&lt; Val1, Val1 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute timeLimit(5) with type INTEGER
        |  %%-------------------------------------------------
<font color=red>     0..|  [V5|Tlv6] = Tlv5, </font>
<font color=red>     0..|  Term5 = begin</font>
<font color=red>     0..|  Val2 = decode_integer(V5, [2]),</font>
<font color=red>     0..|  if 0 =&lt; Val2, Val2 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val2;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute typesOnly(6) with type BOOLEAN
        |  %%-------------------------------------------------
<font color=red>     0..|  [V6|Tlv7] = Tlv6, </font>
<font color=red>     0..|  Term6 = decode_boolean(V6, [1]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute filter(7)   External ELDAPv3:Filter
        |  %%-------------------------------------------------
<font color=red>     0..|  [V7|Tlv8] = Tlv7, </font>
<font color=red>     0..|  Term7 = 'dec_Filter'(V7, []),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(8)   External ELDAPv3:AttributeDescriptionList
        |  %%-------------------------------------------------
<font color=red>     0..|  [V8|Tlv9] = Tlv8, </font>
<font color=red>     0..|  Term8 = 'dec_AttributeDescriptionList'(V8, [16]),</font>
        |  
<font color=red>     0..|  case Tlv9 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv9}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'SearchRequest', Term1, Term2, Term3, Term4, Term5, Term6, Term7, Term8}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  Filter
        |  %%================================
        |  'enc_Filter'(Val) -&gt;
<font color=red>     0..|      'enc_Filter'(Val, []).</font>
        |  
        |  'enc_Filter'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = case element(1,Val) of</font>
        |        'and' -&gt;
<font color=red>     0..|           'enc_Filter_and'(element(2,Val), [&lt;&lt;160&gt;&gt;]);</font>
        |        'or' -&gt;
<font color=red>     0..|           'enc_Filter_or'(element(2,Val), [&lt;&lt;161&gt;&gt;]);</font>
        |        'not' -&gt;
<font color=red>     0..|           'enc_Filter'(element(2,Val), [&lt;&lt;162&gt;&gt;]);</font>
        |        equalityMatch -&gt;
<font color=red>     0..|           'enc_AttributeValueAssertion'(element(2,Val), [&lt;&lt;163&gt;&gt;]);</font>
        |        substrings -&gt;
<font color=red>     0..|           'enc_SubstringFilter'(element(2,Val), [&lt;&lt;164&gt;&gt;]);</font>
        |        greaterOrEqual -&gt;
<font color=red>     0..|           'enc_AttributeValueAssertion'(element(2,Val), [&lt;&lt;165&gt;&gt;]);</font>
        |        lessOrEqual -&gt;
<font color=red>     0..|           'enc_AttributeValueAssertion'(element(2,Val), [&lt;&lt;166&gt;&gt;]);</font>
        |        present -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;135&gt;&gt;]);</font>
        |        approxMatch -&gt;
<font color=red>     0..|           'enc_AttributeValueAssertion'(element(2,Val), [&lt;&lt;168&gt;&gt;]);</font>
        |        extensibleMatch -&gt;
<font color=red>     0..|           'enc_MatchingRuleAssertion'(element(2,Val), [&lt;&lt;169&gt;&gt;]);</font>
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_type,Else}}})</font>
        |     end,
        |  
<font color=red>     0..|  encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  Filter_and
        |  %%================================
        |  'enc_Filter_and'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_Filter_and_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_Filter_and_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_Filter_and_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_Filter'(H, []),</font>
<font color=red>     0..|     'enc_Filter_and_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_Filter_and'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_Filter'(V1, []) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  Filter_or
        |  %%================================
        |  'enc_Filter_or'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_Filter_or_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_Filter_or_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_Filter_or_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_Filter'(H, []),</font>
<font color=red>     0..|     'enc_Filter_or_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_Filter_or'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_Filter'(V1, []) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  'dec_Filter'(Tlv) -&gt;
<font color=red>     0..|     'dec_Filter'(Tlv, []).</font>
        |  
        |  'dec_Filter'(Tlv, TagIn) -&gt;
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  case (case Tlv1 of [CtempTlv1] -&gt; CtempTlv1; _ -&gt; Tlv1 end) of</font>
        |  
        |  %% 'and'
        |      {131072, V1} -&gt; 
<font color=red>     0..|          {'and', 'dec_Filter_and'(V1, [])};</font>
        |  
        |  
        |  %% 'or'
        |      {131073, V1} -&gt; 
<font color=red>     0..|          {'or', 'dec_Filter_or'(V1, [])};</font>
        |  
        |  
        |  %% 'not'
        |      {131074, V1} -&gt; 
<font color=red>     0..|          {'not', 'dec_Filter'(V1, [])};</font>
        |  
        |  
        |  %% 'equalityMatch'
        |      {131075, V1} -&gt; 
<font color=red>     0..|          {equalityMatch, 'dec_AttributeValueAssertion'(V1, [])};</font>
        |  
        |  
        |  %% 'substrings'
        |      {131076, V1} -&gt; 
<font color=red>     0..|          {substrings, 'dec_SubstringFilter'(V1, [])};</font>
        |  
        |  
        |  %% 'greaterOrEqual'
        |      {131077, V1} -&gt; 
<font color=red>     0..|          {greaterOrEqual, 'dec_AttributeValueAssertion'(V1, [])};</font>
        |  
        |  
        |  %% 'lessOrEqual'
        |      {131078, V1} -&gt; 
<font color=red>     0..|          {lessOrEqual, 'dec_AttributeValueAssertion'(V1, [])};</font>
        |  
        |  
        |  %% 'present'
        |      {131079, V1} -&gt; 
<font color=red>     0..|          {present, decode_octet_string(V1, [])};</font>
        |  
        |  
        |  %% 'approxMatch'
        |      {131080, V1} -&gt; 
<font color=red>     0..|          {approxMatch, 'dec_AttributeValueAssertion'(V1, [])};</font>
        |  
        |  
        |  %% 'extensibleMatch'
        |      {131081, V1} -&gt; 
<font color=red>     0..|          {extensibleMatch, 'dec_MatchingRuleAssertion'(V1, [])};</font>
        |  
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_tag,Else}}})</font>
        |     end
        |  .
        |  
        |  
        |  %%================================
        |  %%  SubstringFilter
        |  %%================================
        |  'enc_SubstringFilter'(Val) -&gt;
<font color=red>     0..|      'enc_SubstringFilter'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_SubstringFilter'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute substrings(2) with type SEQUENCE OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_SubstringFilter_substrings'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  SubstringFilter_substrings
        |  %%================================
        |  'enc_SubstringFilter_substrings'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_SubstringFilter_substrings_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_SubstringFilter_substrings_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_SubstringFilter_substrings_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_SubstringFilter_substrings_SEQOF'(H, []),</font>
<font color=red>     0..|     'enc_SubstringFilter_substrings_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  SubstringFilter_substrings_SEQOF
        |  %%================================
        |  'enc_SubstringFilter_substrings_SEQOF'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = case element(1,Val) of</font>
        |        initial -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;128&gt;&gt;]);</font>
        |        any -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;129&gt;&gt;]);</font>
        |        final -&gt;
<font color=red>     0..|           encode_restricted_string(element(2,Val), [&lt;&lt;130&gt;&gt;]);</font>
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_type,Else}}})</font>
        |     end,
        |  
<font color=red>     0..|  encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  
        |  'dec_SubstringFilter_substrings_SEQOF'(Tlv, TagIn) -&gt;
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  case (case Tlv1 of [CtempTlv1] -&gt; CtempTlv1; _ -&gt; Tlv1 end) of</font>
        |  
        |  %% 'initial'
        |      {131072, V1} -&gt; 
<font color=red>     0..|          {initial, decode_octet_string(V1, [])};</font>
        |  
        |  
        |  %% 'any'
        |      {131073, V1} -&gt; 
<font color=red>     0..|          {any, decode_octet_string(V1, [])};</font>
        |  
        |  
        |  %% 'final'
        |      {131074, V1} -&gt; 
<font color=red>     0..|          {final, decode_octet_string(V1, [])};</font>
        |  
        |        Else -&gt; 
<font color=red>     0..|           exit({error,{asn1,{invalid_choice_tag,Else}}})</font>
        |     end
        |  .
        |  'dec_SubstringFilter_substrings'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_SubstringFilter_substrings_SEQOF'(V1, []) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  'dec_SubstringFilter'(Tlv) -&gt;
<font color=red>     0..|     'dec_SubstringFilter'(Tlv, [16]).</font>
        |  
        |  'dec_SubstringFilter'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute substrings(2) with type SEQUENCE OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_SubstringFilter_substrings'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'SubstringFilter', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  MatchingRuleAssertion
        |  %%================================
        |  'enc_MatchingRuleAssertion'(Val) -&gt;
<font color=red>     0..|      'enc_MatchingRuleAssertion'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_MatchingRuleAssertion'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchingRule(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} =  case Cindex1 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex1, [&lt;&lt;129&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} =  case Cindex2 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex2, [&lt;&lt;130&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchValue(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = encode_restricted_string(Cindex3, [&lt;&lt;131&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute dnAttributes(4) with type BOOLEAN DEFAULT = false
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} =  case Cindex4 of</font>
<font color=red>     0..|           asn1_DEFAULT -&gt; {&lt;&lt;&gt;&gt;,0};</font>
<font color=red>     0..|           false -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_boolean(Cindex4, [&lt;&lt;132&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_MatchingRuleAssertion'(Tlv) -&gt;
<font color=red>     0..|     'dec_MatchingRuleAssertion'(Tlv, [16]).</font>
        |  
        |  'dec_MatchingRuleAssertion'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchingRule(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term1,Tlv2} = case Tlv1 of</font>
        |  [{131073,V1}|TempTlv2] -&gt;
<font color=red>     0..|      {decode_octet_string(V1, []), TempTlv2};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv1}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term2,Tlv3} = case Tlv2 of</font>
        |  [{131074,V2}|TempTlv3] -&gt;
<font color=red>     0..|      {decode_octet_string(V2, []), TempTlv3};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv2}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchValue(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = decode_octet_string(V3, [131075]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute dnAttributes(4) with type BOOLEAN DEFAULT = false
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term4,Tlv5} = case Tlv4 of</font>
        |  [{131076,V4}|TempTlv5] -&gt;
<font color=red>     0..|      {decode_boolean(V4, []), TempTlv5};</font>
        |      _ -&gt;
<font color=red>     0..|          {false,Tlv4}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv5 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv5}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'MatchingRuleAssertion', Term1, Term2, Term3, Term4}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  SearchResultEntry
        |  %%================================
        |  'enc_SearchResultEntry'(Val) -&gt;
<font color=red>     0..|      'enc_SearchResultEntry'(Val, [&lt;&lt;100&gt;&gt;]).</font>
        |  
        |  'enc_SearchResultEntry'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute objectName(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(2)   External ELDAPv3:PartialAttributeList
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_PartialAttributeList'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_SearchResultEntry'(Tlv) -&gt;
<font color=red>     0..|     'dec_SearchResultEntry'(Tlv, [65540]).</font>
        |  
        |  'dec_SearchResultEntry'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute objectName(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(2)   External ELDAPv3:PartialAttributeList
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_PartialAttributeList'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'SearchResultEntry', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  PartialAttributeList
        |  %%================================
        |  'enc_PartialAttributeList'(Val) -&gt;
<font color=red>     0..|      'enc_PartialAttributeList'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_PartialAttributeList'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_PartialAttributeList_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_PartialAttributeList_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_PartialAttributeList_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_PartialAttributeList_SEQOF'(H, [&lt;&lt;48&gt;&gt;]),</font>
<font color=red>     0..|     'enc_PartialAttributeList_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  PartialAttributeList_SEQOF
        |  %%================================
        |  'enc_PartialAttributeList_SEQOF'(Val, TagIn) -&gt;
<font color=red>     0..|     {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_PartialAttributeList_SEQOF_vals'(Cindex2, [&lt;&lt;49&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  PartialAttributeList_SEQOF_vals
        |  %%================================
        |  'enc_PartialAttributeList_SEQOF_vals'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_PartialAttributeList_SEQOF_vals_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_PartialAttributeList_SEQOF_vals_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_PartialAttributeList_SEQOF_vals_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_PartialAttributeList_SEQOF_vals_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_PartialAttributeList_SEQOF_vals'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  'dec_PartialAttributeList_SEQOF'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_PartialAttributeList_SEQOF_vals'(V2, [17]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'PartialAttributeList_SEQOF', Term1, Term2}.</font>
        |  
        |  
        |  
        |  'dec_PartialAttributeList'(Tlv) -&gt;
<font color=red>     0..|     'dec_PartialAttributeList'(Tlv, [16]).</font>
        |  
        |  'dec_PartialAttributeList'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_PartialAttributeList_SEQOF'(V1, [16]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  SearchResultReference
        |  %%================================
        |  'enc_SearchResultReference'(Val) -&gt;
<font color=red>     0..|      'enc_SearchResultReference'(Val, [&lt;&lt;115&gt;&gt;]).</font>
        |  
        |  'enc_SearchResultReference'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_SearchResultReference_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_SearchResultReference_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_SearchResultReference_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_SearchResultReference_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  'dec_SearchResultReference'(Tlv) -&gt;
<font color=red>     0..|     'dec_SearchResultReference'(Tlv, [65555]).</font>
        |  
        |  'dec_SearchResultReference'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  SearchResultDone
        |  %%================================
        |  'enc_SearchResultDone'(Val) -&gt;
<font color=red>     0..|      'enc_SearchResultDone'(Val, [&lt;&lt;101&gt;&gt;]).</font>
        |  
        |  'enc_SearchResultDone'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_SearchResultDone'(Tlv) -&gt;
<font color=red>     0..|     'dec_SearchResultDone'(Tlv, [65541]).</font>
        |  
        |  'dec_SearchResultDone'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyRequest
        |  %%================================
        |  'enc_ModifyRequest'(Val) -&gt;
<font color=red>     0..|      'enc_ModifyRequest'(Val, [&lt;&lt;102&gt;&gt;]).</font>
        |  
        |  'enc_ModifyRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute object(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute modification(2) with type SEQUENCE OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_ModifyRequest_modification'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyRequest_modification
        |  %%================================
        |  'enc_ModifyRequest_modification'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_ModifyRequest_modification_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_ModifyRequest_modification_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_ModifyRequest_modification_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_ModifyRequest_modification_SEQOF'(H, [&lt;&lt;48&gt;&gt;]),</font>
<font color=red>     0..|     'enc_ModifyRequest_modification_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyRequest_modification_SEQOF
        |  %%================================
        |  'enc_ModifyRequest_modification_SEQOF'(Val, TagIn) -&gt;
<font color=red>     0..|     {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute operation(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = case Cindex1 of</font>
<font color=red>     0..|  add -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  delete -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  replace -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  Enumval1 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute modification(2)   External ELDAPv3:AttributeTypeAndValues
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_AttributeTypeAndValues'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  'dec_ModifyRequest_modification_SEQOF'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute operation(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = case decode_integer(V1, [10]) of</font>
<font color=red>     0..|  0 -&gt; add;</font>
<font color=red>     0..|  1 -&gt; delete;</font>
<font color=red>     0..|  2 -&gt; replace;</font>
<font color=red>     0..|  Default1 -&gt; exit({error,{asn1,{illegal_enumerated,Default1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute modification(2)   External ELDAPv3:AttributeTypeAndValues
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_AttributeTypeAndValues'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'ModifyRequest_modification_SEQOF', Term1, Term2}.</font>
        |  
        |  'dec_ModifyRequest_modification'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_ModifyRequest_modification_SEQOF'(V1, [16]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  'dec_ModifyRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_ModifyRequest'(Tlv, [65542]).</font>
        |  
        |  'dec_ModifyRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute object(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute modification(2) with type SEQUENCE OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_ModifyRequest_modification'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'ModifyRequest', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeTypeAndValues
        |  %%================================
        |  'enc_AttributeTypeAndValues'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeTypeAndValues'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_AttributeTypeAndValues'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_AttributeTypeAndValues_vals'(Cindex2, [&lt;&lt;49&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeTypeAndValues_vals
        |  %%================================
        |  'enc_AttributeTypeAndValues_vals'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_AttributeTypeAndValues_vals_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_AttributeTypeAndValues_vals_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_AttributeTypeAndValues_vals_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_AttributeTypeAndValues_vals_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_AttributeTypeAndValues_vals'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  'dec_AttributeTypeAndValues'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeTypeAndValues'(Tlv, [16]).</font>
        |  
        |  'dec_AttributeTypeAndValues'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_AttributeTypeAndValues_vals'(V2, [17]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'AttributeTypeAndValues', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyResponse
        |  %%================================
        |  'enc_ModifyResponse'(Val) -&gt;
<font color=red>     0..|      'enc_ModifyResponse'(Val, [&lt;&lt;103&gt;&gt;]).</font>
        |  
        |  'enc_ModifyResponse'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_ModifyResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_ModifyResponse'(Tlv, [65543]).</font>
        |  
        |  'dec_ModifyResponse'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AddRequest
        |  %%================================
        |  'enc_AddRequest'(Val) -&gt;
<font color=red>     0..|      'enc_AddRequest'(Val, [&lt;&lt;104&gt;&gt;]).</font>
        |  
        |  'enc_AddRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(2)   External ELDAPv3:AttributeList
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_AttributeList'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_AddRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_AddRequest'(Tlv, [65544]).</font>
        |  
        |  'dec_AddRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute attributes(2)   External ELDAPv3:AttributeList
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_AttributeList'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'AddRequest', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeList
        |  %%================================
        |  'enc_AttributeList'(Val) -&gt;
<font color=red>     0..|      'enc_AttributeList'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_AttributeList'(Val, TagIn) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_AttributeList_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_AttributeList_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_AttributeList_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = 'enc_AttributeList_SEQOF'(H, [&lt;&lt;48&gt;&gt;]),</font>
<font color=red>     0..|     'enc_AttributeList_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeList_SEQOF
        |  %%================================
        |  'enc_AttributeList_SEQOF'(Val, TagIn) -&gt;
<font color=red>     0..|     {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_AttributeList_SEQOF_vals'(Cindex2, [&lt;&lt;49&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AttributeList_SEQOF_vals
        |  %%================================
        |  'enc_AttributeList_SEQOF_vals'(Val, TagIn) -&gt;
<font color=red>     0..|        {EncBytes,EncLen} = 'enc_AttributeList_SEQOF_vals_components'(Val,[],0),</font>
<font color=red>     0..|     encode_tags(TagIn, EncBytes, EncLen).</font>
        |  
        |  'enc_AttributeList_SEQOF_vals_components'([], AccBytes, AccLen) -&gt; 
<font color=red>     0..|     {lists:reverse(AccBytes),AccLen};</font>
        |  
        |  'enc_AttributeList_SEQOF_vals_components'([H|T],AccBytes, AccLen) -&gt;
<font color=red>     0..|     {EncBytes,EncLen} = encode_restricted_string(H, [&lt;&lt;4&gt;&gt;]),</font>
<font color=red>     0..|     'enc_AttributeList_SEQOF_vals_components'(T,[EncBytes|AccBytes], AccLen + EncLen).</font>
        |  
        |  'dec_AttributeList_SEQOF_vals'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  [decode_octet_string(V1, [4]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  'dec_AttributeList_SEQOF'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute type(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute vals(2) with type SET OF
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_AttributeList_SEQOF_vals'(V2, [17]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'AttributeList_SEQOF', Term1, Term2}.</font>
        |  
        |  
        |  
        |  'dec_AttributeList'(Tlv) -&gt;
<font color=red>     0..|     'dec_AttributeList'(Tlv, [16]).</font>
        |  
        |  'dec_AttributeList'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|  ['dec_AttributeList_SEQOF'(V1, [16]) || V1 &lt;- Tlv1].</font>
        |  
        |  
        |  
        |  
        |  %%================================
        |  %%  AddResponse
        |  %%================================
        |  'enc_AddResponse'(Val) -&gt;
<font color=red>     0..|      'enc_AddResponse'(Val, [&lt;&lt;105&gt;&gt;]).</font>
        |  
        |  'enc_AddResponse'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_AddResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_AddResponse'(Tlv, [65545]).</font>
        |  
        |  'dec_AddResponse'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  DelRequest
        |  %%================================
        |  'enc_DelRequest'(Val) -&gt;
<font color=red>     0..|      'enc_DelRequest'(Val, [&lt;&lt;74&gt;&gt;]).</font>
        |  
        |  'enc_DelRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_restricted_string(Val, TagIn).</font>
        |  
        |  
        |  'dec_DelRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_DelRequest'(Tlv, [65546]).</font>
        |  
        |  'dec_DelRequest'(Tlv, TagIn) -&gt;
<font color=red>     0..|  decode_octet_string(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  DelResponse
        |  %%================================
        |  'enc_DelResponse'(Val) -&gt;
<font color=red>     0..|      'enc_DelResponse'(Val, [&lt;&lt;107&gt;&gt;]).</font>
        |  
        |  'enc_DelResponse'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_DelResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_DelResponse'(Tlv, [65547]).</font>
        |  
        |  'dec_DelResponse'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyDNRequest
        |  %%================================
        |  'enc_ModifyDNRequest'(Val) -&gt;
<font color=red>     0..|      'enc_ModifyDNRequest'(Val, [&lt;&lt;108&gt;&gt;]).</font>
        |  
        |  'enc_ModifyDNRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute newrdn(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute deleteoldrdn(3) with type BOOLEAN
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = encode_boolean(Cindex3, [&lt;&lt;1&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute newSuperior(4) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} =  case Cindex4 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex4, [&lt;&lt;128&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_ModifyDNRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_ModifyDNRequest'(Tlv, [65548]).</font>
        |  
        |  'dec_ModifyDNRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute newrdn(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute deleteoldrdn(3) with type BOOLEAN
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = decode_boolean(V3, [1]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute newSuperior(4) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term4,Tlv5} = case Tlv4 of</font>
        |  [{131072,V4}|TempTlv5] -&gt;
<font color=red>     0..|      {decode_octet_string(V4, []), TempTlv5};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv4}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv5 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv5}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'ModifyDNRequest', Term1, Term2, Term3, Term4}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ModifyDNResponse
        |  %%================================
        |  'enc_ModifyDNResponse'(Val) -&gt;
<font color=red>     0..|      'enc_ModifyDNResponse'(Val, [&lt;&lt;109&gt;&gt;]).</font>
        |  
        |  'enc_ModifyDNResponse'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_ModifyDNResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_ModifyDNResponse'(Tlv, [65549]).</font>
        |  
        |  'dec_ModifyDNResponse'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  CompareRequest
        |  %%================================
        |  'enc_CompareRequest'(Val) -&gt;
<font color=red>     0..|      'enc_CompareRequest'(Val, [&lt;&lt;110&gt;&gt;]).</font>
        |  
        |  'enc_CompareRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute ava(2)   External ELDAPv3:AttributeValueAssertion
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = 'enc_AttributeValueAssertion'(Cindex2, [&lt;&lt;48&gt;&gt;]),</font>
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_CompareRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_CompareRequest'(Tlv, [65550]).</font>
        |  
        |  'dec_CompareRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute entry(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute ava(2)   External ELDAPv3:AttributeValueAssertion
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = 'dec_AttributeValueAssertion'(V2, [16]),</font>
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'CompareRequest', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  CompareResponse
        |  %%================================
        |  'enc_CompareResponse'(Val) -&gt;
<font color=red>     0..|      'enc_CompareResponse'(Val, [&lt;&lt;111&gt;&gt;]).</font>
        |  
        |  'enc_CompareResponse'(Val, TagIn) -&gt;
<font color=red>     0..|     'enc_LDAPResult'(Val, TagIn).</font>
        |  
        |  
        |  'dec_CompareResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_CompareResponse'(Tlv, [65551]).</font>
        |  
        |  'dec_CompareResponse'(Tlv, TagIn) -&gt;
<font color=red>     0..|  'dec_LDAPResult'(Tlv, TagIn).</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  AbandonRequest
        |  %%================================
        |  'enc_AbandonRequest'(Val) -&gt;
<font color=red>     0..|      'enc_AbandonRequest'(Val, [&lt;&lt;80&gt;&gt;]).</font>
        |  
        |  'enc_AbandonRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  encode_integer(Val, TagIn).</font>
        |  
        |  
        |  'dec_AbandonRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_AbandonRequest'(Tlv, [65552]).</font>
        |  
        |  'dec_AbandonRequest'(Tlv, TagIn) -&gt;
<font color=red>     0..|  begin</font>
<font color=red>     0..|  Val1 = decode_integer(Tlv, TagIn),</font>
<font color=red>     0..|  if 0 =&lt; Val1, Val1 =&lt; 2147483647 -&gt;</font>
<font color=red>     0..|  Val1;</font>
        |  true -&gt;
<font color=red>     0..|  exit({error,{asn1,bad_range}})</font>
        |  end
        |  end.
        |  
        |  
        |  
        |  %%================================
        |  %%  ExtendedRequest
        |  %%================================
        |  'enc_ExtendedRequest'(Val) -&gt;
<font color=red>     0..|      'enc_ExtendedRequest'(Val, [&lt;&lt;119&gt;&gt;]).</font>
        |  
        |  'enc_ExtendedRequest'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute requestName(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = encode_restricted_string(Cindex1, [&lt;&lt;128&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute requestValue(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} =  case Cindex2 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex2, [&lt;&lt;129&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_ExtendedRequest'(Tlv) -&gt;
<font color=red>     0..|     'dec_ExtendedRequest'(Tlv, [65559]).</font>
        |  
        |  'dec_ExtendedRequest'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute requestName(1) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = decode_octet_string(V1, [131072]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute requestValue(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term2,Tlv3} = case Tlv2 of</font>
        |  [{131073,V2}|TempTlv3] -&gt;
<font color=red>     0..|      {decode_octet_string(V2, []), TempTlv3};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv2}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv3 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv3}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'ExtendedRequest', Term1, Term2}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  ExtendedResponse
        |  %%================================
        |  'enc_ExtendedResponse'(Val) -&gt;
<font color=red>     0..|      'enc_ExtendedResponse'(Val, [&lt;&lt;120&gt;&gt;]).</font>
        |  
        |  'enc_ExtendedResponse'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3, Cindex4, Cindex5, Cindex6} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} = case Cindex1 of</font>
<font color=red>     0..|  success -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [0], 1);</font>
<font color=red>     0..|  operationsError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [1], 1);</font>
<font color=red>     0..|  protocolError -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [2], 1);</font>
<font color=red>     0..|  timeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [3], 1);</font>
<font color=red>     0..|  sizeLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [4], 1);</font>
<font color=red>     0..|  compareFalse -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [5], 1);</font>
<font color=red>     0..|  compareTrue -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [6], 1);</font>
<font color=red>     0..|  authMethodNotSupported -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [7], 1);</font>
<font color=red>     0..|  strongAuthRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [8], 1);</font>
<font color=red>     0..|  referral -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [10], 1);</font>
<font color=red>     0..|  adminLimitExceeded -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [11], 1);</font>
<font color=red>     0..|  unavailableCriticalExtension -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [12], 1);</font>
<font color=red>     0..|  confidentialityRequired -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [13], 1);</font>
<font color=red>     0..|  saslBindInProgress -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [14], 1);</font>
<font color=red>     0..|  noSuchAttribute -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [16], 1);</font>
<font color=red>     0..|  undefinedAttributeType -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [17], 1);</font>
<font color=red>     0..|  inappropriateMatching -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [18], 1);</font>
<font color=red>     0..|  constraintViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [19], 1);</font>
<font color=red>     0..|  attributeOrValueExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [20], 1);</font>
<font color=red>     0..|  invalidAttributeSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [21], 1);</font>
<font color=red>     0..|  noSuchObject -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [32], 1);</font>
<font color=red>     0..|  aliasProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [33], 1);</font>
<font color=red>     0..|  invalidDNSyntax -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [34], 1);</font>
<font color=red>     0..|  aliasDereferencingProblem -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [36], 1);</font>
<font color=red>     0..|  inappropriateAuthentication -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [48], 1);</font>
<font color=red>     0..|  invalidCredentials -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [49], 1);</font>
<font color=red>     0..|  insufficientAccessRights -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [50], 1);</font>
<font color=red>     0..|  busy -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [51], 1);</font>
<font color=red>     0..|  unavailable -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [52], 1);</font>
<font color=red>     0..|  unwillingToPerform -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [53], 1);</font>
<font color=red>     0..|  loopDetect -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [54], 1);</font>
<font color=red>     0..|  namingViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [64], 1);</font>
<font color=red>     0..|  objectClassViolation -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [65], 1);</font>
<font color=red>     0..|  notAllowedOnNonLeaf -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [66], 1);</font>
<font color=red>     0..|  notAllowedOnRDN -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [67], 1);</font>
<font color=red>     0..|  entryAlreadyExists -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [68], 1);</font>
<font color=red>     0..|  objectClassModsProhibited -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [69], 1);</font>
<font color=red>     0..|  affectsMultipleDSAs -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [71], 1);</font>
<font color=red>     0..|  other -&gt; encode_tags([&lt;&lt;10&gt;&gt;], [80], 1);</font>
<font color=red>     0..|  Enumval1 -&gt; exit({error,{asn1, {enumerated_not_in_range,Enumval1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} = encode_restricted_string(Cindex2, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} = encode_restricted_string(Cindex3, [&lt;&lt;4&gt;&gt;]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes4,EncLen4} =  case Cindex4 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              'enc_Referral'(Cindex4, [&lt;&lt;163&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute responseName(5) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes5,EncLen5} =  case Cindex5 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex5, [&lt;&lt;138&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute response(6) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes6,EncLen6} =  case Cindex6 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex6, [&lt;&lt;139&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3, EncBytes4, EncBytes5, EncBytes6],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3 + EncLen4 + EncLen5 + EncLen6,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_ExtendedResponse'(Tlv) -&gt;
<font color=red>     0..|     'dec_ExtendedResponse'(Tlv, [65560]).</font>
        |  
        |  'dec_ExtendedResponse'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute resultCode(1) with type ENUMERATED
        |  %%-------------------------------------------------
<font color=red>     0..|  [V1|Tlv2] = Tlv1, </font>
<font color=red>     0..|  Term1 = case decode_integer(V1, [10]) of</font>
<font color=red>     0..|  0 -&gt; success;</font>
<font color=red>     0..|  1 -&gt; operationsError;</font>
<font color=red>     0..|  2 -&gt; protocolError;</font>
<font color=red>     0..|  3 -&gt; timeLimitExceeded;</font>
<font color=red>     0..|  4 -&gt; sizeLimitExceeded;</font>
<font color=red>     0..|  5 -&gt; compareFalse;</font>
<font color=red>     0..|  6 -&gt; compareTrue;</font>
<font color=red>     0..|  7 -&gt; authMethodNotSupported;</font>
<font color=red>     0..|  8 -&gt; strongAuthRequired;</font>
<font color=red>     0..|  10 -&gt; referral;</font>
<font color=red>     0..|  11 -&gt; adminLimitExceeded;</font>
<font color=red>     0..|  12 -&gt; unavailableCriticalExtension;</font>
<font color=red>     0..|  13 -&gt; confidentialityRequired;</font>
<font color=red>     0..|  14 -&gt; saslBindInProgress;</font>
<font color=red>     0..|  16 -&gt; noSuchAttribute;</font>
<font color=red>     0..|  17 -&gt; undefinedAttributeType;</font>
<font color=red>     0..|  18 -&gt; inappropriateMatching;</font>
<font color=red>     0..|  19 -&gt; constraintViolation;</font>
<font color=red>     0..|  20 -&gt; attributeOrValueExists;</font>
<font color=red>     0..|  21 -&gt; invalidAttributeSyntax;</font>
<font color=red>     0..|  32 -&gt; noSuchObject;</font>
<font color=red>     0..|  33 -&gt; aliasProblem;</font>
<font color=red>     0..|  34 -&gt; invalidDNSyntax;</font>
<font color=red>     0..|  36 -&gt; aliasDereferencingProblem;</font>
<font color=red>     0..|  48 -&gt; inappropriateAuthentication;</font>
<font color=red>     0..|  49 -&gt; invalidCredentials;</font>
<font color=red>     0..|  50 -&gt; insufficientAccessRights;</font>
<font color=red>     0..|  51 -&gt; busy;</font>
<font color=red>     0..|  52 -&gt; unavailable;</font>
<font color=red>     0..|  53 -&gt; unwillingToPerform;</font>
<font color=red>     0..|  54 -&gt; loopDetect;</font>
<font color=red>     0..|  64 -&gt; namingViolation;</font>
<font color=red>     0..|  65 -&gt; objectClassViolation;</font>
<font color=red>     0..|  66 -&gt; notAllowedOnNonLeaf;</font>
<font color=red>     0..|  67 -&gt; notAllowedOnRDN;</font>
<font color=red>     0..|  68 -&gt; entryAlreadyExists;</font>
<font color=red>     0..|  69 -&gt; objectClassModsProhibited;</font>
<font color=red>     0..|  71 -&gt; affectsMultipleDSAs;</font>
<font color=red>     0..|  80 -&gt; other;</font>
<font color=red>     0..|  Default1 -&gt; exit({error,{asn1,{illegal_enumerated,Default1}}})</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute matchedDN(2) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V2|Tlv3] = Tlv2, </font>
<font color=red>     0..|  Term2 = decode_octet_string(V2, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute errorMessage(3) with type OCTET STRING
        |  %%-------------------------------------------------
<font color=red>     0..|  [V3|Tlv4] = Tlv3, </font>
<font color=red>     0..|  Term3 = decode_octet_string(V3, [4]),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute referral(4)   External ELDAPv3:Referral OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term4,Tlv5} = case Tlv4 of</font>
        |  [{131075,V4}|TempTlv5] -&gt;
<font color=red>     0..|      {'dec_Referral'(V4, []), TempTlv5};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv4}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute responseName(5) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term5,Tlv6} = case Tlv5 of</font>
        |  [{131082,V5}|TempTlv6] -&gt;
<font color=red>     0..|      {decode_octet_string(V5, []), TempTlv6};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv5}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute response(6) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term6,Tlv7} = case Tlv6 of</font>
        |  [{131083,V6}|TempTlv7] -&gt;
<font color=red>     0..|      {decode_octet_string(V6, []), TempTlv7};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv6}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv7 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv7}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'ExtendedResponse', Term1, Term2, Term3, Term4, Term5, Term6}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  PasswdModifyRequestValue
        |  %%================================
        |  'enc_PasswdModifyRequestValue'(Val) -&gt;
<font color=red>     0..|      'enc_PasswdModifyRequestValue'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_PasswdModifyRequestValue'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1, Cindex2, Cindex3} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute userIdentity(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} =  case Cindex1 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex1, [&lt;&lt;128&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute oldPasswd(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes2,EncLen2} =  case Cindex2 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex2, [&lt;&lt;129&gt;&gt;])</font>
        |         end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute newPasswd(3) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes3,EncLen3} =  case Cindex3 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex3, [&lt;&lt;130&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1, EncBytes2, EncBytes3],</font>
<font color=red>     0..|  LenSoFar = EncLen1 + EncLen2 + EncLen3,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_PasswdModifyRequestValue'(Tlv) -&gt;
<font color=red>     0..|     'dec_PasswdModifyRequestValue'(Tlv, [16]).</font>
        |  
        |  'dec_PasswdModifyRequestValue'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute userIdentity(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term1,Tlv2} = case Tlv1 of</font>
        |  [{131072,V1}|TempTlv2] -&gt;
<font color=red>     0..|      {decode_octet_string(V1, []), TempTlv2};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv1}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute oldPasswd(2) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term2,Tlv3} = case Tlv2 of</font>
        |  [{131073,V2}|TempTlv3] -&gt;
<font color=red>     0..|      {decode_octet_string(V2, []), TempTlv3};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv2}</font>
        |  end,
        |  
        |  %%-------------------------------------------------
        |  %% attribute newPasswd(3) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term3,Tlv4} = case Tlv3 of</font>
        |  [{131074,V3}|TempTlv4] -&gt;
<font color=red>     0..|      {decode_octet_string(V3, []), TempTlv4};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv3}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv4 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv4}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'PasswdModifyRequestValue', Term1, Term2, Term3}.</font>
        |  
        |  
        |  
        |  %%================================
        |  %%  PasswdModifyResponseValue
        |  %%================================
        |  'enc_PasswdModifyResponseValue'(Val) -&gt;
<font color=red>     0..|      'enc_PasswdModifyResponseValue'(Val, [&lt;&lt;48&gt;&gt;]).</font>
        |  
        |  'enc_PasswdModifyResponseValue'(Val, TagIn) -&gt;
<font color=red>     0..|  {_,Cindex1} = Val,</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute genPasswd(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|     {EncBytes1,EncLen1} =  case Cindex1 of</font>
<font color=red>     0..|           asn1_NOVALUE -&gt; {&lt;&lt;&gt;&gt;,0};</font>
        |           _ -&gt;
<font color=red>     0..|              encode_restricted_string(Cindex1, [&lt;&lt;128&gt;&gt;])</font>
        |         end,
        |  
<font color=red>     0..|     BytesSoFar = [EncBytes1],</font>
<font color=red>     0..|  LenSoFar = EncLen1,</font>
<font color=red>     0..|  encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  
        |  'dec_PasswdModifyResponseValue'(Tlv) -&gt;
<font color=red>     0..|     'dec_PasswdModifyResponseValue'(Tlv, [16]).</font>
        |  
        |  'dec_PasswdModifyResponseValue'(Tlv, TagIn) -&gt;
        |     %%-------------------------------------------------
        |     %% decode tag and length 
        |     %%-------------------------------------------------
<font color=red>     0..|  Tlv1 = match_tags(Tlv, TagIn),</font>
        |  
        |  %%-------------------------------------------------
        |  %% attribute genPasswd(1) with type OCTET STRING OPTIONAL
        |  %%-------------------------------------------------
<font color=red>     0..|  {Term1,Tlv2} = case Tlv1 of</font>
        |  [{131072,V1}|TempTlv2] -&gt;
<font color=red>     0..|      {decode_octet_string(V1, []), TempTlv2};</font>
        |      _ -&gt;
<font color=red>     0..|          { asn1_NOVALUE, Tlv1}</font>
        |  end,
        |  
<font color=red>     0..|  case Tlv2 of</font>
<font color=red>     0..|  [] -&gt; true;_ -&gt; exit({error,{asn1, {unexpected,Tlv2}}}) % extra fields not allowed</font>
        |  end,
<font color=red>     0..|     {'PasswdModifyResponseValue', Term1}.</font>
        |  
        |  'maxInt'() -&gt;
<font color=red>     0..|  2147483647.</font>
        |  
        |  'passwdModifyOID'() -&gt;
<font color=red>     0..|  &lt;&lt;49,46,51,46,54,46,49,46,52,46,49,46,52,50,48,51,46,49,46,49,49,46,49&gt;&gt;.</font>
        |  
        |  
        |  %%%
        |  %%% Run-time functions.
        |  %%%
        |  
        |  'dialyzer-suppressions'(Arg) -&gt;
<font color=red>     0..|      ok.</font>
        |  
        |  ber_decode_nif(B) -&gt;
<font color=red>     0..|      asn1rt_nif:decode_ber_tlv(B).</font>
        |  
        |  collect_parts(TlvList) -&gt;
<font color=red>     0..|      collect_parts(TlvList, []).</font>
        |  
        |  collect_parts([{_,L}|Rest], Acc) when is_list(L) -&gt;
<font color=red>     0..|      collect_parts(Rest, [collect_parts(L)|Acc]);</font>
        |  collect_parts([{3,&lt;&lt;Unused,Bits/binary&gt;&gt;}|Rest], _Acc) -&gt;
<font color=red>     0..|      collect_parts_bit(Rest, [Bits], Unused);</font>
        |  collect_parts([{_T,V}|Rest], Acc) -&gt;
<font color=red>     0..|      collect_parts(Rest, [V|Acc]);</font>
        |  collect_parts([], Acc) -&gt;
<font color=red>     0..|      list_to_binary(lists:reverse(Acc)).</font>
        |  
        |  collect_parts_bit([{3,&lt;&lt;Unused,Bits/binary&gt;&gt;}|Rest], Acc, Uacc) -&gt;
<font color=red>     0..|      collect_parts_bit(Rest, [Bits|Acc], Unused + Uacc);</font>
        |  collect_parts_bit([], Acc, Uacc) -&gt;
<font color=red>     0..|      list_to_binary([Uacc|lists:reverse(Acc)]).</font>
        |  
        |  decode_boolean(Tlv, TagIn) -&gt;
<font color=red>     0..|      Val = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|      case Val of</font>
        |          &lt;&lt;0:8&gt;&gt; -&gt;
<font color=red>     0..|              false;</font>
        |          &lt;&lt;_:8&gt;&gt; -&gt;
<font color=red>     0..|              true;</font>
        |          _ -&gt;
<font color=red>     0..|              exit({error,{asn1,{decode_boolean,Val}}})</font>
        |      end.
        |  
        |  decode_integer(Tlv, TagIn) -&gt;
<font color=red>     0..|      Bin = match_tags(Tlv, TagIn),</font>
<font color=red>     0..|      Len = byte_size(Bin),</font>
<font color=red>     0..|      &lt;&lt;Int:Len/signed-unit:8&gt;&gt; = Bin,</font>
<font color=red>     0..|      Int.</font>
        |  
        |  decode_null(Tlv, Tags) -&gt;
<font color=red>     0..|      Val = match_tags(Tlv, Tags),</font>
<font color=red>     0..|      case Val of</font>
        |          &lt;&lt;&gt;&gt; -&gt;
<font color=red>     0..|              'NULL';</font>
        |          _ -&gt;
<font color=red>     0..|              exit({error,{asn1,{decode_null,Val}}})</font>
        |      end.
        |  
        |  decode_octet_string(Tlv, TagsIn) -&gt;
<font color=red>     0..|      Bin = match_and_collect(Tlv, TagsIn),</font>
<font color=red>     0..|      binary:copy(Bin).</font>
        |  
        |  encode_boolean(true, TagIn) -&gt;
<font color=red>     0..|      encode_tags(TagIn, [255], 1);</font>
        |  encode_boolean(false, TagIn) -&gt;
<font color=red>     0..|      encode_tags(TagIn, [0], 1);</font>
        |  encode_boolean(X, _) -&gt;
<font color=red>     0..|      exit({error,{asn1,{encode_boolean,X}}}).</font>
        |  
        |  encode_integer(Val) -&gt;
<font color=red>     0..|      Bytes =</font>
        |          if
        |              Val &gt;= 0 -&gt;
<font color=red>     0..|                  encode_integer_pos(Val, []);</font>
        |              true -&gt;
<font color=red>     0..|                  encode_integer_neg(Val, [])</font>
        |          end,
<font color=red>     0..|      {Bytes,length(Bytes)}.</font>
        |  
        |  encode_integer(Val, Tag) when is_integer(Val) -&gt;
<font color=red>     0..|      encode_tags(Tag, encode_integer(Val));</font>
        |  encode_integer(Val, _Tag) -&gt;
<font color=red>     0..|      exit({error,{asn1,{encode_integer,Val}}}).</font>
        |  
        |  encode_integer_neg(- 1, [B1|_T] = L) when B1 &gt; 127 -&gt;
<font color=red>     0..|      L;</font>
        |  encode_integer_neg(N, Acc) -&gt;
<font color=red>     0..|      encode_integer_neg(N bsr 8, [N band 255|Acc]).</font>
        |  
        |  encode_integer_pos(0, [B|_Acc] = L) when B &lt; 128 -&gt;
<font color=red>     0..|      L;</font>
        |  encode_integer_pos(N, Acc) -&gt;
<font color=red>     0..|      encode_integer_pos(N bsr 8, [N band 255|Acc]).</font>
        |  
        |  encode_length(L) when L =&lt; 127 -&gt;
<font color=red>     0..|      {[L],1};</font>
        |  encode_length(L) -&gt;
<font color=red>     0..|      Oct = minimum_octets(L),</font>
<font color=red>     0..|      Len = length(Oct),</font>
<font color=red>     0..|      if</font>
        |          Len =&lt; 126 -&gt;
<font color=red>     0..|              {[128 bor Len|Oct],Len + 1};</font>
        |          true -&gt;
<font color=red>     0..|              exit({error,{asn1,too_long_length_oct,Len}})</font>
        |      end.
        |  
        |  encode_null(_Val, TagIn) -&gt;
<font color=red>     0..|      encode_tags(TagIn, [], 0).</font>
        |  
        |  encode_restricted_string(OctetList, TagIn) when is_binary(OctetList) -&gt;
<font color=red>     0..|      encode_tags(TagIn, OctetList, byte_size(OctetList));</font>
        |  encode_restricted_string(OctetList, TagIn) when is_list(OctetList) -&gt;
<font color=red>     0..|      encode_tags(TagIn, OctetList, length(OctetList)).</font>
        |  
        |  encode_tags(TagIn, {BytesSoFar,LenSoFar}) -&gt;
<font color=red>     0..|      encode_tags(TagIn, BytesSoFar, LenSoFar).</font>
        |  
        |  encode_tags([Tag|Trest], BytesSoFar, LenSoFar) -&gt;
<font color=red>     0..|      {Bytes2,L2} = encode_length(LenSoFar),</font>
<font color=red>     0..|      encode_tags(Trest,</font>
        |                  [Tag,Bytes2|BytesSoFar],
        |                  LenSoFar + byte_size(Tag) + L2);
        |  encode_tags([], BytesSoFar, LenSoFar) -&gt;
<font color=red>     0..|      {BytesSoFar,LenSoFar}.</font>
        |  
        |  match_and_collect(Tlv, TagsIn) -&gt;
<font color=red>     0..|      Val = match_tags(Tlv, TagsIn),</font>
<font color=red>     0..|      case Val of</font>
        |          [_|_] = PartList -&gt;
<font color=red>     0..|              collect_parts(PartList);</font>
        |          Bin when is_binary(Bin) -&gt;
<font color=red>     0..|              Bin</font>
        |      end.
        |  
        |  match_tags({T,V}, [T]) -&gt;
<font color=red>     0..|      V;</font>
        |  match_tags({T,V}, [T|Tt]) -&gt;
<font color=red>     0..|      match_tags(V, Tt);</font>
        |  match_tags([{T,V}], [T|Tt]) -&gt;
<font color=red>     0..|      match_tags(V, Tt);</font>
        |  match_tags([{T,_V}|_] = Vlist, [T]) -&gt;
<font color=red>     0..|      Vlist;</font>
        |  match_tags(Tlv, []) -&gt;
<font color=red>     0..|      Tlv;</font>
        |  match_tags({Tag,_V} = Tlv, [T|_Tt]) -&gt;
<font color=red>     0..|      exit({error,{asn1,{wrong_tag,{{expected,T},{got,Tag,Tlv}}}}}).</font>
        |  
        |  minimum_octets(0, Acc) -&gt;
<font color=red>     0..|      Acc;</font>
        |  minimum_octets(Val, Acc) -&gt;
<font color=red>     0..|      minimum_octets(Val bsr 8, [Val band 255|Acc]).</font>
        |  
        |  minimum_octets(Val) -&gt;
<font color=red>     0..|      minimum_octets(Val, []).</font>
</pre>
</body>
</html>
